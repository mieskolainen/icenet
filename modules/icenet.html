

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>icenet &mdash; icenet alpha documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="iceplot" href="iceplot.html" />
    <link rel="prev" title="iceid" href="iceid.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> icenet
          

          
          </a>

          
            
            
              <div class="version">
                0.02
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#preliminaries-conda-installation">Preliminaries: Conda installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#pre-installed-cuda-paths-optional">Pre-installed CUDA paths (optional)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#fully-automated-setup">Fully automated setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#gpu-support-commands">GPU-support commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#conda-virtual-environment-setup">Conda virtual environment setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#xgboost-setup">XGBoost setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#pytorch-and-torchvision-setup">Pytorch and torchvision setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#pytorch-geometric-setup">Pytorch-geometric setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#folder-structure">Folder structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#electron-id-classifier">Electron ID classifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#b-r-k-analyzer">B/R(K) analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#algorithms-packages-included">Algorithms/packages included</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/markup.html">Markup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="icebrk.html">icebrk</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#module-icebrk.common">icebrk.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#icebrk-cutstats">icebrk.cutstats</a></li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#icebrk-fasthistos">icebrk.fasthistos</a></li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#icebrk-features">icebrk.features</a></li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#icebrk-histos">icebrk.histos</a></li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#icebrk-loop">icebrk.loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#icebrk-tools">icebrk.tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icefit.html">icefit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icefit.html#module-icefit.em">icefit.em</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iceid.html">iceid</a><ul>
<li class="toctree-l2"><a class="reference internal" href="iceid.html#module-iceid.common">iceid.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="iceid.html#module-iceid.graphio">iceid.graphio</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">icenet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#icenet-algo">icenet.algo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.algo.analytic">icenet.algo.analytic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.algo.flr">icenet.algo.flr</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#icenet-deep">icenet.deep</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.bnaf">icenet.deep.bnaf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.cnn">icenet.deep.cnn</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.dbnf">icenet.deep.dbnf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.deps">icenet.deep.deps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.dopt">icenet.deep.dopt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.gcnn">icenet.deep.gcnn</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.graph">icenet.deep.graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.maxo">icenet.deep.maxo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.deep.mlgr">icenet.deep.mlgr</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#icenet-optim">icenet.optim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.optim.adam">icenet.optim.adam</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.optim.adamax">icenet.optim.adamax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.optim.scheduler">icenet.optim.scheduler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#icenet-tools">icenet.tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.tools.aux">icenet.tools.aux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.tools.io">icenet.tools.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.tools.plots">icenet.tools.plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-icenet.tools.prints">icenet.tools.prints</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iceplot.html">iceplot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="iceplot.html#module-iceplot.iceplot">iceplot.iceplot</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">icenet</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>icenet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/icenet.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="icenet">
<h1>icenet<a class="headerlink" href="#icenet" title="Permalink to this headline">¶</a></h1>
<p>Core classes including deep learning, data structures, manipulations and visualizations.</p>
<div class="section" id="icenet-algo">
<h2>icenet.algo<a class="headerlink" href="#icenet-algo" title="Permalink to this headline">¶</a></h2>
<p>Various algorithms.</p>
<div class="section" id="module-icenet.algo.analytic">
<span id="icenet-algo-analytic"></span><h3>icenet.algo.analytic<a class="headerlink" href="#module-icenet.algo.analytic" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.analytic.fox_wolfram_boost_inv">
<span class="sig-name descname"><span class="pre">fox_wolfram_boost_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/analytic.html#fox_wolfram_boost_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.analytic.fox_wolfram_boost_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>arxiv.org/pdf/1508.03144, (Formula 5.6)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – list of 4-momentum vectors</p></li>
<li><p><strong>L</strong> – maximum angular moment order</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of moments of order 0,1,…,L</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>S</p>
</dd>
</dl>
<p>[untested function]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.analytic.gram_matrix">
<span class="sig-name descname"><span class="pre">gram_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dot'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/analytic.html#gram_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.analytic.gram_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Gram matrix for 4-vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Array (list of N) of 4-vectors</p></li>
<li><p><strong>type</strong> – Type of Lorentz scalars computed (‘dot’, ‘s’, ‘t’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gram matrix (NxN)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>G</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.analytic.ktmetric">
<span class="sig-name descname"><span class="pre">ktmetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kt2_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt2_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dR2_ij</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/analytic.html#ktmetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.analytic.ktmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>kt-algorithm type distance measure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kt2_i</strong> – Particle 1 pt squared</p></li>
<li><p><strong>kt2_j</strong> – Particle 2 pt squared</p></li>
<li><p><strong>delta2_ij</strong> – Angular seperation between particles squared (deta**2 + dphi**2)</p></li>
<li><p><strong>R</strong> – Radius parameter</p></li>
<li><p><strong>1</strong> (<em>p =</em>) – (p=1) kt-like, (p=0) Cambridge/Aachen, (p=-1) anti-kt like</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>distance measure</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-icenet.algo.flr">
<span id="icenet-algo-flr"></span><h3>icenet.algo.flr<a class="headerlink" href="#module-icenet.algo.flr" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.flr.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_pdfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_pdfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/flr.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.flr.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the likelihood ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – input data [# vectors x # dimensions]</p></li>
<li><p><strong>b_pdfs</strong> – background pdfs</p></li>
<li><p><strong>s_pdfs</strong> – signal pdfs</p></li>
<li><p><strong>bin_edges</strong> – bin edges</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>likelihood ratio</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>LR</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.flr.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/flr.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.flr.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorized likelihood classifier training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – input data [# vectors x # dimensions]</p></li>
<li><p><strong>y</strong> – target data</p></li>
<li><p><strong>weights</strong> – weighted events</p></li>
<li><p><strong>param</strong> – dictionary for the parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>background pdfs
s_pdfs:    signal pdfs
bin_edges: histogram bin edges</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>b_pdfs</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="icenet-deep">
<h2>icenet.deep<a class="headerlink" href="#icenet-deep" title="Permalink to this headline">¶</a></h2>
<p>Deep learning model classes.</p>
<div class="section" id="module-icenet.deep.bnaf">
<span id="icenet-deep-bnaf"></span><h3>icenet.deep.bnaf<a class="headerlink" href="#module-icenet.deep.bnaf" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.BNAF">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">BNAF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#BNAF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.BNAF" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that extends <code class="docutils literal notranslate"><span class="pre">torch.nn.Sequential</span></code> for constructing a Block Neural
Normalizing Flow.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.BNAF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#BNAF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.BNAF.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>torch.Tensor</strong> – </p></li>
<li><p><strong>tensor.</strong> (<em>required. The input</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output tensor and the log-det-Jacobian of this transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.bnaf.BNAF.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.bnaf.BNAF.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.MaskedWeight">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">MaskedWeight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#MaskedWeight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.MaskedWeight" title="Permalink to this definition">¶</a></dt>
<dd><p>Module that implements a linear layer with block matrices with positive diagonal blocks.
Moreover, it uses Weight Normalization (<a class="reference external" href="https://arxiv.org/abs/1602.07868">https://arxiv.org/abs/1602.07868</a>) for stability.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.MaskedWeight.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#MaskedWeight.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.MaskedWeight.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, required. The input tensor.</p></li>
<li><p><strong>grad</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, optional.</p></li>
<li><p><strong>transformations.</strong> (<em>The log diagonal block of the partial Jacobian of previous</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output tensor and the log diagonal blocks of the partial log-Jacobian of previous
transformations combined with this transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.MaskedWeight.get_weights">
<span class="sig-name descname"><span class="pre">get_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#MaskedWeight.get_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.MaskedWeight.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the weight matrix using masks and weight normalization.
It also compute the log diagonal blocks of it.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.bnaf.MaskedWeight.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.bnaf.MaskedWeight.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Permutation">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Permutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><span class="pre">list</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Permutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Module that outputs a permutation of its input.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Permutation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Permutation.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Permutation.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, required. The input tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The permuted tensor and the log-det-Jacobian of this permutation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Permutation.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.bnaf.Permutation.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Sequential">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Sequential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Sequential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Sequential" title="Permalink to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Sequential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">OrderedDict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Class that extends <code class="docutils literal notranslate"><span class="pre">torch.nn.Sequential</span></code> for computing the output of
the function together with the log-det-Jacobian of such transformation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Sequential.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Sequential.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Sequential.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>torch.Tensor</strong> – </p></li>
<li><p><strong>tensor.</strong> (<em>required. The input</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output tensor and the log-det-Jacobian of this transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Sequential.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.bnaf.Sequential.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Tanh">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Tanh</span></span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that extends <code class="docutils literal notranslate"><span class="pre">torch.nn.Tanh</span></code> additionally computing the log diagonal
blocks of the Jacobian.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Tanh.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Tanh.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Tanh.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, required. The input tensor.</p></li>
<li><p><strong>grad</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, optional.</p></li>
<li><p><strong>transformations.</strong> (<em>The log diagonal blocks of the partial Jacobian of previous</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output tensor and the log diagonal blocks of the partial log-Jacobian of previous
transformations combined with this transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Tanh.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.bnaf.Tanh.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-icenet.deep.cnn">
<span id="icenet-deep-cnn"></span><h3>icenet.deep.cnn<a class="headerlink" href="#module-icenet.deep.cnn" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">CNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_cnn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_mlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.cnn.CNN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">CNN_DMAX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_cnn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_mlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN_DMAX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX" title="Permalink to this definition">¶</a></dt>
<dd><p>Dual (simultaneous) input network [image tensors x global vectors]</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN_DMAX.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Input data dictionary with members</dt><dd><p>‘x’ : as image tensor
‘u’’ : global feature tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX.maxout">
<span class="sig-name descname"><span class="pre">maxout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN_DMAX.maxout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX.maxout" title="Permalink to this definition">¶</a></dt>
<dd><p>MAXOUT layer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN_DMAX.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-icenet.deep.dbnf">
<span id="icenet-deep-dbnf"></span><h3>icenet.deep.dbnf<a class="headerlink" href="#module-icenet.deep.dbnf" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.dbnf.Dataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.Dataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.compute_log_p_x">
<span class="sig-name descname"><span class="pre">compute_log_p_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#compute_log_p_x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.compute_log_p_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Model log-likelihood: log [ prod_{j=1}^N pdf(x_j)], where x ~ (iid) pdf(x)</p>
<p>log p(x) = log p(z) + sum_{k=1}^K log|det J_{f_k}|</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model object</p></li>
<li><p><strong>x</strong> – N minibatch vectors</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>log-likelihood value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.create_model">
<span class="sig-name descname"><span class="pre">create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#create_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.create_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the network object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>param</strong> – parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.get_pdf">
<span class="sig-name descname"><span class="pre">get_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#get_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.get_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate learned density (pdf) at point x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model object</p></li>
<li><p><strong>x</strong> – input vector(s)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pdf value</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>&gt; x = torch.tensor([[1.0, 2.0]])
&gt; l = get_pdf(model,x)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.load_models">
<span class="sig-name descname"><span class="pre">load_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeldir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#load_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.load_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Load models from files</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>2-class density ratio pdf(x,S) / pdf(x,B) for each vector x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> – input parameters</p></li>
<li><p><strong>X</strong> – pytorch tensor of vectors</p></li>
<li><p><strong>models</strong> – list of model objects</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>log-likelihood ratio</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>LLR</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trn_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trn_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeldir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the model density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – initialized model object</p></li>
<li><p><strong>optimizer</strong> – optimizer object</p></li>
<li><p><strong>scheduler</strong> – optimization scheduler</p></li>
<li><p><strong>trn_x</strong> – training vectors</p></li>
<li><p><strong>val_x</strong> – validation vectors</p></li>
<li><p><strong>trn_weights</strong> – training weights</p></li>
<li><p><strong>param</strong> – parameters</p></li>
<li><p><strong>modeldir</strong> – directory to save the model</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-icenet.deep.deps">
<span id="icenet-deep-deps"></span><h3>icenet.deep.deps<a class="headerlink" href="#module-icenet.deep.deps" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">DEPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#DEPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.DEPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation equivariant networks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS.binarypredict">
<span class="sig-name descname"><span class="pre">binarypredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#DEPS.binarypredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.DEPS.binarypredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#DEPS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.DEPS.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#DEPS.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.DEPS.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.DEPS.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_max">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">PEN1_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN1_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN1_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation Equivariant Network (PEN) max-type layers.</p>
<p>Single dimensional model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_max.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN1_max.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN1_max.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_max.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.PEN1_max.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_mean">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">PEN1_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN1_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN1_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation Equivariant Network (PEN) mean-type layers.</p>
<p>Single dimensional model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_mean.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN1_mean.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN1_mean.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_mean.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.PEN1_mean.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_max">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">PEN_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation Equivariant Network (PEN) max-type layers.</p>
<p>Multidimensional model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_max.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN_max.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN_max.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_max.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.PEN_max.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_mean">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">PEN_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation Equivariant Network (PEN) mean-type layers.</p>
<p>Multidimensional model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_mean.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN_mean.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN_mean.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_mean.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.PEN_mean.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-icenet.deep.dopt">
<span id="icenet-deep-dopt"></span><h3>icenet.deep.dopt<a class="headerlink" href="#module-icenet.deep.dopt" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.dopt.Dataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.Dataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.dopt.DualDataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">DualDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#DualDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.DualDataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.log_softmax">
<span class="sig-name descname"><span class="pre">log_softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#log_softmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.log_softmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Log of softmax</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – network output without softmax</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>logsoftmax values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.log_sum_exp">
<span class="sig-name descname"><span class="pre">log_sum_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#log_sum_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.log_sum_exp" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://timvieira.github.io/blog/post/2014/02/11/exp-normalize-trick/">http://timvieira.github.io/blog/post/2014/02/11/exp-normalize-trick/</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.logsumexp">
<span class="sig-name descname"><span class="pre">logsumexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#logsumexp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.logsumexp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.model_to_cuda">
<span class="sig-name descname"><span class="pre">model_to_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#model_to_cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.model_to_cuda" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to handle CPU/GPU setup</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.multiclass_cross_entropy">
<span class="sig-name descname"><span class="pre">multiclass_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#multiclass_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.multiclass_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Per instance weighted cross entropy loss
(negative log-likelihood)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.multiclass_cross_entropy_logprob">
<span class="sig-name descname"><span class="pre">multiclass_cross_entropy_logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_phat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#multiclass_cross_entropy_logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.multiclass_cross_entropy_logprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Per instance weighted cross entropy loss
(negative log-likelihood)</p>
<p>Numerically more stable version.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.multiclass_focal_entropy">
<span class="sig-name descname"><span class="pre">multiclass_focal_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#multiclass_focal_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.multiclass_focal_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Per instance weighted ‘focal entropy loss’
<a class="reference external" href="https://arxiv.org/pdf/1708.02002.pdf">https://arxiv.org/pdf/1708.02002.pdf</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.multiclass_focal_entropy_logprob">
<span class="sig-name descname"><span class="pre">multiclass_focal_entropy_logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_phat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#multiclass_focal_entropy_logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.multiclass_focal_entropy_logprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Per instance weighted ‘focal entropy loss’
<a class="reference external" href="https://arxiv.org/pdf/1708.02002.pdf">https://arxiv.org/pdf/1708.02002.pdf</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_trn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_trn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trn_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeldir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Main training loop</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.weights_init_all">
<span class="sig-name descname"><span class="pre">weights_init_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_funcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#weights_init_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.weights_init_all" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<p>model = MyNet()
weights_init_all(model, init_funcs)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.weights_init_normal">
<span class="sig-name descname"><span class="pre">weights_init_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#weights_init_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.weights_init_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes module weights from normal distribution
with a rule sigma ~ 1/sqrt(n)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.weights_init_uniform_rule">
<span class="sig-name descname"><span class="pre">weights_init_uniform_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#weights_init_uniform_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.weights_init_uniform_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes module weights from uniform [-a,a]</p>
</dd></dl>

</div>
<div class="section" id="module-icenet.deep.gcnn">
<span id="icenet-deep-gcnn"></span><h3>icenet.deep.gcnn<a class="headerlink" href="#module-icenet.deep.gcnn" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">GCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph Convolution Network</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.gcnn.GCN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN_layer">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">GCN_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph Convolution Network Layer</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN_layer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN_layer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN_layer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward operator</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN_layer.reset_param">
<span class="sig-name descname"><span class="pre">reset_param</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN_layer.reset_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN_layer.reset_param" title="Permalink to this definition">¶</a></dt>
<dd><p>1 / sqrt(N) normalization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN_layer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.gcnn.GCN_layer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-icenet.deep.graph">
<span id="icenet-deep-graph"></span><h3>icenet.deep.graph<a class="headerlink" href="#module-icenet.deep.graph" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.DECNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">DECNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#DECNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.DECNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.DECNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#DECNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.DECNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.DECNet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#DECNet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.DECNet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.DECNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.DECNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.ECNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">ECNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#ECNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.ECNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.ECNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#ECNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.ECNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.ECNet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#ECNet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.ECNet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.ECNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.ECNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.GATNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">GATNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#GATNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.GATNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.GATNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#GATNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.GATNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.GATNet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#GATNet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.GATNet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.GATNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.GATNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.GINENet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">GINENet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#GINENet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.GINENet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.GINENet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#GINENet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.GINENet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.GINENet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#GINENet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.GINENet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.GINENet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.GINENet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.graph.MLP">
<span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.MLP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Multi Layer Perceptron with an arbitrary number of layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channels</strong> – input structure, such as [128, 64, 64] for a 3-layer network.</p></li>
<li><p><strong>batch_norm</strong> – batch normalization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nn.sequential object</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.NNNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">NNNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'add'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'s2s'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#NNNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.NNNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.NNNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#NNNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.NNNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.NNNet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#NNNet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.NNNet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.NNNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.NNNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.PANNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">PANNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#PANNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.PANNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.PANNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#PANNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.PANNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.PANNet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#PANNet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.PANNet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.PANNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.PANNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.SAGENet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SAGENet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SAGENet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SAGENet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SAGENet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SAGENet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SAGENet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SAGENet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SAGENet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SAGENet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.SAGENet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.SAGENet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.SGNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SGNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SGNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SGNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SGNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SGNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SGNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SGNet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SGNet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SGNet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.SGNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.SGNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.SUPNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SUPNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">96</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SUPNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SUPNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SUPNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SUPNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SUPNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SUPNet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SUPNet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SUPNet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.SUPNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.SUPNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.SplineNet">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SplineNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SplineNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SplineNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SplineNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SplineNet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SplineNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SplineNet.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SplineNet.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SplineNet.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.graph.SplineNet.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.graph.SplineNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.graph.SuperEdgeConv">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SuperEdgeConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nn</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SuperEdgeConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SuperEdgeConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom convolution operator.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SuperEdgeConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">torch_sparse.tensor.SparseTensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_attr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SuperEdgeConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SuperEdgeConv.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.graph.SuperEdgeConv.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_i</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_j</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_attr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../_modules/icenet/deep/graph.html#SuperEdgeConv.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.SuperEdgeConv.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs messages from node <span class="math notranslate nohighlight">\(j\)</span> to node <span class="math notranslate nohighlight">\(i\)</span>
in analogy to <span class="math notranslate nohighlight">\(\phi_{\mathbf{\Theta}}\)</span> for each edge in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_index</span></code>.
This function can take any argument as input which was initially
passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code>.
Furthermore, tensors passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">propagate()</span></code> can be mapped to the
respective nodes <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> by appending <code class="xref py py-obj docutils literal notranslate"><span class="pre">_i</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_j</span></code> to the variable name, <em>.e.g.</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">x_j</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.graph.test">
<span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Pytorch geometric based testing routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – pytorch geometric model</p></li>
<li><p><strong>loader</strong> – pytorch geometric dataloader</p></li>
<li><p><strong>optimizer</strong> – pytorch optimizer</p></li>
<li><p><strong>device</strong> – ‘cpu’ or ‘device’</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p>accuracy, auc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.graph.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/graph.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.graph.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Pytorch geometric based training routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – pytorch geometric model</p></li>
<li><p><strong>loader</strong> – pytorch geometric dataloader</p></li>
<li><p><strong>optimizer</strong> – pytorch optimizer</p></li>
<li><p><strong>device</strong> – ‘cpu’ or ‘device’</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p>trained model (return implicit via input arguments)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-icenet.deep.maxo">
<span id="icenet-deep-maxo"></span><h3>icenet.deep.maxo<a class="headerlink" href="#module-icenet.deep.maxo" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">MAXOUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neurons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT" title="Permalink to this definition">¶</a></dt>
<dd><p>MAXOUT network</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.binarypredict">
<span class="sig-name descname"><span class="pre">binarypredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT.binarypredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.binarypredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return max probability class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.maxout">
<span class="sig-name descname"><span class="pre">maxout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT.maxout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.maxout" title="Permalink to this definition">¶</a></dt>
<dd><p>MAXOUT layer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.softpredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Softmax probability</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-icenet.deep.mlgr">
<span id="icenet-deep-mlgr"></span><h3>icenet.deep.mlgr<a class="headerlink" href="#module-icenet.deep.mlgr" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">MLGR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/mlgr.html#MLGR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.mlgr.MLGR" title="Permalink to this definition">¶</a></dt>
<dd><p>Multinomial Logistic Regression model</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR.binarypredict">
<span class="sig-name descname"><span class="pre">binarypredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/mlgr.html#MLGR.binarypredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.mlgr.MLGR.binarypredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return maximum probability class</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/mlgr.html#MLGR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.mlgr.MLGR.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/mlgr.html#MLGR.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.mlgr.MLGR.softpredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Softmax probability</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.mlgr.MLGR.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="icenet-optim">
<h2>icenet.optim<a class="headerlink" href="#icenet-optim" title="Permalink to this headline">¶</a></h2>
<p>Custom optimization functions.</p>
<div class="section" id="module-icenet.optim.adam">
<span id="icenet-optim-adam"></span><h3>icenet.optim.adam<a class="headerlink" href="#module-icenet.optim.adam" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.optim.adam.Adam">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Adam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.9,</span> <span class="pre">0.999)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amsgrad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adam.html#Adam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adam.Adam" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adam.Adam.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adam.html#Adam.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adam.Adam.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single optimization step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>closure</strong> (<em>callable</em><em>, </em><em>optional</em>) – A closure that reevaluates the model
and returns the loss.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adam.Adam.substitute">
<span class="sig-name descname"><span class="pre">substitute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adam.html#Adam.substitute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adam.Adam.substitute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adam.Adam.swap">
<span class="sig-name descname"><span class="pre">swap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adam.html#Adam.swap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adam.Adam.swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Swapping the running average of params and the current params for saving parameters using polyak averaging</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-icenet.optim.adamax">
<span id="icenet-optim-adamax"></span><h3>icenet.optim.adamax<a class="headerlink" href="#module-icenet.optim.adamax" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.optim.adamax.Adamax">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Adamax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.9,</span> <span class="pre">0.999)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adamax.html#Adamax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adamax.Adamax" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adamax.Adamax.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adamax.html#Adamax.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adamax.Adamax.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single optimization step (parameter update).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>closure</strong> (<em>callable</em>) – A closure that reevaluates the model and
returns the loss. Optional for most optimizers.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unless otherwise specified, this function should not modify the
<code class="docutils literal notranslate"><span class="pre">.grad</span></code> field of the parameters.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adamax.Adamax.substitute">
<span class="sig-name descname"><span class="pre">substitute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adamax.html#Adamax.substitute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adamax.Adamax.substitute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adamax.Adamax.swap">
<span class="sig-name descname"><span class="pre">swap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adamax.html#Adamax.swap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adamax.Adamax.swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Swapping the running average of params and the current params for saving parameters using polyak averaging</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-icenet.optim.scheduler">
<span id="icenet-optim-scheduler"></span><h3>icenet.optim.scheduler<a class="headerlink" href="#module-icenet.optim.scheduler" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.optim.scheduler.ReduceLROnPlateau">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">ReduceLROnPlateau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/scheduler.html#ReduceLROnPlateau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.scheduler.ReduceLROnPlateau" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.scheduler.ReduceLROnPlateau.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_best</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/scheduler.html#ReduceLROnPlateau.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.scheduler.ReduceLROnPlateau.step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="icenet-tools">
<h2>icenet.tools<a class="headerlink" href="#icenet-tools" title="Permalink to this headline">¶</a></h2>
<p>Tool and auxiliary functions.</p>
<div class="section" id="module-icenet.tools.aux">
<span id="icenet-tools-aux"></span><h3>icenet.tools.aux<a class="headerlink" href="#module-icenet.tools.aux" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.aux.Metric">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_soft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#Metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.Metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifier performance evaluation metrics.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.apply_algebra_operator">
<span class="sig-name descname"><span class="pre">apply_algebra_operator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ope_lhs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#apply_algebra_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.apply_algebra_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Algebraic operators applied</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – left hand side (string)</p></li>
<li><p><strong>ope</strong> – algebraic operator (string)</p></li>
<li><p><strong>b</strong> – right hand side (bool, float)</p></li>
<li><p><strong>ope_lhs</strong> – operator applied on left hand side first (e.g. ‘abs’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.apply_cutflow">
<span class="sig-name descname"><span class="pre">apply_cutflow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcorr_flow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#apply_cutflow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.apply_cutflow" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply cutflow</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cut</strong> – list of pre-calculated cuts, each is a boolean array</p></li>
<li><p><strong>names</strong> – list of names (description of each cut, for printout only)</p></li>
<li><p><strong>xcorr_flow</strong> – compute full N-point correlations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of indices, 1 = pass, 0 = fail</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ind</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.arrays2matrix">
<span class="sig-name descname"><span class="pre">arrays2matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_binedges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_binedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#arrays2matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.arrays2matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Array representation summed to matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_arr</strong> – array of [x values]</p></li>
<li><p><strong>y_arr</strong> – array of [y values]</p></li>
<li><p><strong>z_arr</strong> – array of [z values]</p></li>
<li><p><strong>x_binedges</strong> – array of binedges</p></li>
<li><p><strong>y_binedges</strong> – array of binedges</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrix output</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.balanceweights">
<span class="sig-name descname"><span class="pre">balanceweights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_doublet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#balanceweights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.balanceweights" title="Permalink to this definition">¶</a></dt>
<dd><p>Balance N-class weights to sum to equal counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights_doublet</strong> – N-class event weights (events x classes)</p></li>
<li><p><strong>reference_class</strong> – which class gives the reference (integer)</p></li>
<li><p><strong>y</strong> – class targets</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights doublet with new weights per event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.bin2int">
<span class="sig-name descname"><span class="pre">bin2int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#bin2int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.bin2int" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary vector to integer.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.bin_array">
<span class="sig-name descname"><span class="pre">bin_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#bin_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.bin_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a positive integer num into an N-bit bit vector.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binaryvec2int">
<span class="sig-name descname"><span class="pre">binaryvec2int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binaryvec2int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binaryvec2int" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a matrix of binary vectors row-by-row into integer reps.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binom_coeff_all">
<span class="sig-name descname"><span class="pre">binom_coeff_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAX</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binom_coeff_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binom_coeff_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum all all binomial coefficients up to MAX.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binomial">
<span class="sig-name descname"><span class="pre">binomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Binomial coefficient C(n,k).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binvec2powersetindex">
<span class="sig-name descname"><span class="pre">binvec2powersetindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binvec2powersetindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binvec2powersetindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary vector to powerset index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – matrix of binary vectors [# number of vectors x dimension]</p></li>
<li><p><strong>B</strong> – the powerset matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of powerset indices</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binvec_are_equal">
<span class="sig-name descname"><span class="pre">binvec_are_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binvec_are_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binvec_are_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare equality of two binary vectors a and b.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – binary vectors</p></li>
<li><p><strong>b</strong> – binary vectors</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p>true or false</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.construct_columnar_cuts">
<span class="sig-name descname"><span class="pre">construct_columnar_cuts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VARS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutlist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#construct_columnar_cuts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.construct_columnar_cuts" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct cuts and corresponding names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input columnar data matrix</p></li>
<li><p><strong>VARS</strong> – Variable names for each column of X</p></li>
<li><p><strong>cutlist</strong> – Selection cuts as strings, such as [‘<a href="#id1"><span class="problematic" id="id2">|eta|</span></a> &lt; 0.5’, ‘trigger0 == True’]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cuts, names</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.construct_cut_tuplets">
<span class="sig-name descname"><span class="pre">construct_cut_tuplets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutlist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#construct_cut_tuplets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.construct_cut_tuplets" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct cuts 4-tuplets from a list of strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cutlist</strong> – For example [‘var_y &lt; 0.5’, ‘var_x == True’]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of 4-tuplets of cuts (var, operator, value, lhs_operator)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.count_targets">
<span class="sig-name descname"><span class="pre">count_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entrystart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entrystop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#count_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.count_targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Targets statistics printout</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>events</strong> – uproot object</p></li>
<li><p><strong>names</strong> – list of branch names</p></li>
<li><p><strong>entrystart</strong> – uproot starting point</p></li>
<li><p><strong>entrystop</strong> – uproot ending point</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Printout on stdout</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.create_model_filename">
<span class="sig-name descname"><span class="pre">create_model_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#create_model_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.create_model_filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.deltaphi">
<span class="sig-name descname"><span class="pre">deltaphi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#deltaphi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.deltaphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Deltaphi measure.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.deltar">
<span class="sig-name descname"><span class="pre">deltar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#deltar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.deltar" title="Permalink to this definition">¶</a></dt>
<dd><p>DeltaR measure.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.generatebinary">
<span class="sig-name descname"><span class="pre">generatebinary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#generatebinary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.generatebinary" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate all 2**N binary vectors (as boolean matrix rows)
with 1 &lt;= M &lt;= N number of ones (hot bits) (default N)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.generatebinary_fixed">
<span class="sig-name descname"><span class="pre">generatebinary_fixed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#generatebinary_fixed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.generatebinary_fixed" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all combinations of n bits with fixed k ones.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.hardclass">
<span class="sig-name descname"><span class="pre">hardclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_soft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#hardclass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.hardclass" title="Permalink to this definition">¶</a></dt>
<dd><p>Soft decision to hard decision at point (valrange[1] - valrange[0]) / 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y_soft</strong> – probabilities for two classes</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>classification results</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y_out</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.int2onehot">
<span class="sig-name descname"><span class="pre">int2onehot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#int2onehot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.int2onehot" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer class vector to class “one-hot encoding”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> – Class indices (# samples)</p></li>
<li><p><strong>N_classes</strong> – Number of classes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Onehot representation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>onehot</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.jagged2tensor">
<span class="sig-name descname"><span class="pre">jagged2tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VARS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_binedges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_binedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#jagged2tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.jagged2tensor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – input data (samples x dimensions) with jagged structure</p></li>
<li><p><strong>VARS</strong> – all variable names</p></li>
<li><p><strong>xyz</strong> – array of (x,y,z) channel triplet strings such as [[‘image_clu_eta’, ‘image_clu_phi’, ‘image_clu_e’]]</p></li>
<li><p><strong>x_binedges</strong> – </p></li>
<li><p><strong>y_binedges</strong> – arrays of bin edges</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor of size (samples x channels x rows x columns)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>T</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.load_torch_checkpoint">
<span class="sig-name descname"><span class="pre">load_torch_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mynet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#load_torch_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.load_torch_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pytorch checkpoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – folder path</p></li>
<li><p><strong>label</strong> – model label name</p></li>
<li><p><strong>epoch</strong> – epoch index. Use -1 for the last epoch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pytorch model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.load_torch_model">
<span class="sig-name descname"><span class="pre">load_torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_start_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#load_torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.load_torch_model" title="Permalink to this definition">¶</a></dt>
<dd><p>PyTorch model loader</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.longvec2matrix">
<span class="sig-name descname"><span class="pre">longvec2matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#longvec2matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.longvec2matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>A matrix representation / dimension converter function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input matrix</p></li>
<li><p><strong>M</strong> – Number of set elements</p></li>
<li><p><strong>D</strong> – Feature dimension</p></li>
<li><p><strong>order</strong> – Reshape direction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Y</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>X = [# number of samples N ] x [# M x D long feature vectors]
–&gt;
Y = [# number of samples N ] x [# number of set elements M] x [# vector dimension D]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.los2lol">
<span class="sig-name descname"><span class="pre">los2lol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">listOsets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#los2lol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.los2lol" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of sets [{},{},..,{}] to a list of of lists [[], [], …, []].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.merge_connected">
<span class="sig-name descname"><span class="pre">merge_connected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#merge_connected"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.merge_connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge sets with common elements (find connected graphs problem).</p>
<p class="rubric">Examples</p>
<p>Input:  [{0, 1}, {0, 1}, {2, 3}, {2, 3}, {4, 5}, {4, 5}, {6, 7}, {6, 7}, {8, 9}, {8, 9}, {10}, {11}]
Output: [{0, 1}, {2, 3}, {4, 5}, {6, 7}, {8, 9}, {10}, {11}]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.multiclass_roc_auc_score">
<span class="sig-name descname"><span class="pre">multiclass_roc_auc_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_soft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'macro'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#multiclass_roc_auc_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.multiclass_roc_auc_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiclass AUC (area under the curve).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> – True classifications</p></li>
<li><p><strong>y_soft</strong> – Soft probabilities</p></li>
<li><p><strong>average</strong> – Averaging strategy</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Area under the curve via averaging</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>auc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.number_of_set_bits">
<span class="sig-name descname"><span class="pre">number_of_set_bits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#number_of_set_bits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.number_of_set_bits" title="Permalink to this definition">¶</a></dt>
<dd><p>Return how many bits are active of an integer in a standard binary representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.pdf_1D_hist">
<span class="sig-name descname"><span class="pre">pdf_1D_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#pdf_1D_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.pdf_1D_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute re-weighting 1D pdfs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.pdf_2D_hist">
<span class="sig-name descname"><span class="pre">pdf_2D_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binedges_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binedges_B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#pdf_2D_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.pdf_2D_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute re-weighting 2D pdfs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.pick_ind">
<span class="sig-name descname"><span class="pre">pick_ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#pick_ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.pick_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return indices between minmax[0] and minmax[1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input vector</p></li>
<li><p><strong>minmax</strong> – Minimum and maximum values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>indices</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.reweight_1D">
<span class="sig-name descname"><span class="pre">reweight_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#reweight_1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.reweight_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-class density reweighting coefficients.
:param X: Input data (# samples)
:param pdf: Dictionary of pdfs for each class
:param y: Class target data (# samples)
:param N_class: Number of classes
:param reference_class: Target class of re-weighting</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>weights for each event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.reweightcoeff1D">
<span class="sig-name descname"><span class="pre">reweightcoeff1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#reweightcoeff1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.reweightcoeff1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-class density reweighting coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Observable of interest (N x 1)</p></li>
<li><p><strong>y</strong> – Class labels (0,1,…) (N x 1)</p></li>
<li><p><strong>pdf</strong> – PDF for each class</p></li>
<li><p><strong>N_class</strong> – Number of classes</p></li>
<li><p><strong>equal_frac</strong> – equalize class fractions</p></li>
<li><p><strong>reference_class</strong> – e.g. 0 (background) or 1 (signal)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights for each event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.reweightcoeff2D">
<span class="sig-name descname"><span class="pre">reweightcoeff2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#reweightcoeff2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.reweightcoeff2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-class density reweighting coefficients.</p>
<p>Operates in full 2D without factorization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_A</strong> – Observable A of interest (N x 1)</p></li>
<li><p><strong>X_B</strong> – Observable B of interest (N x 1)</p></li>
<li><p><strong>y</strong> – Signal (1) and background (0) labels (N x 1)</p></li>
<li><p><strong>pdf</strong> – Density histograms for each class</p></li>
<li><p><strong>N_class</strong> – Number of classes</p></li>
<li><p><strong>reference_class</strong> – e.g. Background (0) or signal (1)</p></li>
<li><p><strong>equal_frac</strong> – Equalize class fractions</p></li>
<li><p><strong>max_reg</strong> – Regularize the maximum reweight coefficient</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights for each event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.reweightcoeff2DFP">
<span class="sig-name descname"><span class="pre">reweightcoeff2DFP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#reweightcoeff2DFP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.reweightcoeff2DFP" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-class density reweighting coefficients.</p>
<p>Operates in 2D with FACTORIZED PRODUCT marginal 1D distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_A</strong> – Observable of interest (N x 1)</p></li>
<li><p><strong>X_B</strong> – Observable of interest (N x 1)</p></li>
<li><p><strong>y</strong> – Signal (1) and background (0) targets</p></li>
<li><p><strong>pdf_A</strong> – Density of observable A</p></li>
<li><p><strong>pdf_B</strong> – Density of observable B</p></li>
<li><p><strong>N_class</strong> – Number of classes</p></li>
<li><p><strong>reference_class</strong> – e.g. 0 (background) or 1 (signal)</p></li>
<li><p><strong>equal_frac</strong> – Equalize integrated class fractions</p></li>
<li><p><strong>max_reg</strong> – Maximum weight regularization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights for each event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.save_torch_model">
<span class="sig-name descname"><span class="pre">save_torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#save_torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.save_torch_model" title="Permalink to this definition">¶</a></dt>
<dd><p>PyTorch model saver</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator which returns approx equally sized chunks.
:param a: Total number
:param n: Number of chunks</p>
<p class="rubric">Example</p>
<p>list(split(10, 3))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.split_start_end">
<span class="sig-name descname"><span class="pre">split_start_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#split_start_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.split_start_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns approx equally sized chunks.
:param a: Total number
:param n: Number of chunks</p>
<p class="rubric">Example</p>
<p>list(split(10, 3))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.to_edges">
<span class="sig-name descname"><span class="pre">to_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#to_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.to_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>treat <cite>l</cite> as a Graph and returns it’s edges</p>
<p class="rubric">Examples</p>
<p>to_edges([‘a’,’b’,’c’,’d’]) -&gt; [(a,b), (b,c),(c,d)]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.to_graph">
<span class="sig-name descname"><span class="pre">to_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#to_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.to_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn the list into a graph.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.weight2onehot">
<span class="sig-name descname"><span class="pre">weight2onehot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#weight2onehot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.weight2onehot" title="Permalink to this definition">¶</a></dt>
<dd><p>Weights into one-hot encoding.
:param weights: array of weights
:param Y: targets
:param N_classes: number of classes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.x2ind">
<span class="sig-name descname"><span class="pre">x2ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#x2ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.x2ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return histogram bin indices for data in x, which needs to be an array [].
:param x: data to be classified between bin edges
:param binedges: histogram bin edges</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>histogram bin indices</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>inds</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-icenet.tools.io">
<span id="icenet-tools-io"></span><h3>icenet.tools.io<a class="headerlink" href="#module-icenet.tools.io" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.io.DATASET">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">DATASET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngseed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#DATASET"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.DATASET" title="Permalink to this definition">¶</a></dt>
<dd><p>Main class for datasets</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.io.Data">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#Data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.Data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data                [# vectors x # dimensions]</p></li>
<li><p><strong>y</strong> – target output data  [# vectors]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.Data.classfilter">
<span class="sig-name descname"><span class="pre">classfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#Data.classfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.Data.classfilter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.apply_madscore">
<span class="sig-name descname"><span class="pre">apply_madscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_mad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#apply_madscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.apply_madscore" title="Permalink to this definition">¶</a></dt>
<dd><p>MAD-score normalization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.apply_zscore">
<span class="sig-name descname"><span class="pre">apply_zscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#apply_zscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.apply_zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Z-score normalization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.apply_zscore_tensor">
<span class="sig-name descname"><span class="pre">apply_zscore_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#apply_zscore_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.apply_zscore_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply z-score normalization for tensors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.calc_madscore">
<span class="sig-name descname"><span class="pre">calc_madscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#calc_madscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.calc_madscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate robust normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Input with [# vectors x # dimensions]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median vector
X_mad : Median deviation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>X_m</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.calc_zscore">
<span class="sig-name descname"><span class="pre">calc_zscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#calc_zscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.calc_zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 0-mean &amp; unit-variance normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Input with [# vectors x # dimensions]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mean vector
X_std : Standard deviation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>X_mu</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.calc_zscore_tensor">
<span class="sig-name descname"><span class="pre">calc_zscore_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#calc_zscore_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.calc_zscore_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute z-score normalization for tensors.
:param T: input tensor data (events x channels x rows x cols, …)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>mu, std tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.checkinfnan">
<span class="sig-name descname"><span class="pre">checkinfnan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#checkinfnan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.checkinfnan" title="Permalink to this definition">¶</a></dt>
<dd><p>Check inf and Nan values and replace with a default value.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">fastarray1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">capacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1" title="Permalink to this definition">¶</a></dt>
<dd><p>1D pre-memory occupied buffer arrays for histogramming etc.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1.values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1.values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.get_gpu_memory_map">
<span class="sig-name descname"><span class="pre">get_gpu_memory_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#get_gpu_memory_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.get_gpu_memory_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the GPU VRAM use in GB.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary with keys as device ids [integers]
and values the memory used by the GPU.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.impute_data">
<span class="sig-name descname"><span class="pre">impute_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imputer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iterative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#impute_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.impute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Data imputation (treatment of missing values, Nan and Inf).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data matrix [# vectors x # dimensions]</p></li>
<li><p><strong>imputer</strong> – Pre-trained imputator, default None</p></li>
<li><p><strong>dim</strong> – Array of active dimensions to impute</p></li>
<li><p><strong>values</strong> – List of special integer values indicating the need for imputation</p></li>
<li><p><strong>labels</strong> – List containing textual description of input variables</p></li>
<li><p><strong>algorithm</strong> – ‘constant’, mean’, ‘median’, ‘iterative’, knn_k’</p></li>
<li><p><strong>knn_k</strong> – knn k-nearest neighbour parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Imputed output data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>X</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.pick_vars">
<span class="sig-name descname"><span class="pre">pick_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#icenet.tools.io.DATASET" title="icenet.tools.io.DATASET"><span class="pre">icenet.tools.io.DATASET</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_of_variables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#pick_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.pick_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose the active set of input variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.process_memory_use">
<span class="sig-name descname"><span class="pre">process_memory_use</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#process_memory_use"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.process_memory_use" title="Permalink to this definition">¶</a></dt>
<dd><p>Return system memory (RAM) used by the process in GB.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.showmem">
<span class="sig-name descname"><span class="pre">showmem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#showmem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.showmem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.split_data">
<span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngseed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.split_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Split into [A = train &amp; validation] + [B = test] sets</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.torch_cuda_total_memory">
<span class="sig-name descname"><span class="pre">torch_cuda_total_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#torch_cuda_total_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.torch_cuda_total_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Return CUDA device VRAM available in GB.</p>
</dd></dl>

</div>
<div class="section" id="module-icenet.tools.plots">
<span id="icenet-tools-plots"></span><h3>icenet.tools.plots<a class="headerlink" href="#module-icenet.tools.plots" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.ROC_plot">
<span class="sig-name descname"><span class="pre">ROC_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ROC'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#ROC_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.ROC_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Receiver Operating Characteristics i.e. False positive (x) vs True positive (y)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.annotate_heatmap">
<span class="sig-name descname"><span class="pre">annotate_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_rot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#annotate_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.annotate_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Add text annotations to a matrix heatmap plot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.binned_AUC">
<span class="sig-name descname"><span class="pre">binned_AUC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_predict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_kin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VARS_kin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#binned_AUC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.binned_AUC" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate AUC per (pt,eta) bin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func_predict</strong> – Function handle of the classifier</p></li>
<li><p><strong>X</strong> – Input data</p></li>
<li><p><strong>y</strong> – Output (target) data</p></li>
<li><p><strong>X_kin</strong> – Kinematic (pt,eta) data</p></li>
<li><p><strong>VARS_kin</strong> – Kinematic variables (strings)</p></li>
<li><p><strong>pt_edges</strong> – Edges of the pt-space cells</p></li>
<li><p><strong>eta_edges</strong> – Edges of the eta-space cells</p></li>
<li><p><strong>label</strong> – Label of the classifier (string)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure handle and axis
met          :  Metrics object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig,ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plot_auc_matrix">
<span class="sig-name descname"><span class="pre">plot_auc_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">AUC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plot_auc_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plot_auc_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot AUC matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>AUC</strong> – auc matrix</p></li>
<li><p><strong>pt_edges</strong> – transverse momentum histogram edges</p></li>
<li><p><strong>eta_edges</strong> – pseudorapidity histogram edges</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>figure handle
ax:        figure axis</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plot_correlations">
<span class="sig-name descname"><span class="pre">plot_correlations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netvars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plot_correlations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plot_correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot cross-correlations
Data in format (# samples x # dimensions)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plot_decision_contour">
<span class="sig-name descname"><span class="pre">plot_decision_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numpy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plot_decision_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plot_decision_contour" title="Permalink to this definition">¶</a></dt>
<dd><p>Decision contour pairwise for each dimension,
other dimensions evaluated at zero=(0,0,…0)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plot_matrix">
<span class="sig-name descname"><span class="pre">plot_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">XY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdBu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plot_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plot_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plot_reweight_result">
<span class="sig-name descname"><span class="pre">plot_reweight_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trn_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plot_reweight_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plot_reweight_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Here plot pure event counts
so we see that also integrated class fractions are equalized (or not)!</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plot_train_evolution">
<span class="sig-name descname"><span class="pre">plot_train_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trn_aucs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_aucs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plot_train_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plot_train_evolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Training evolution plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>losses</strong> – loss values</p></li>
<li><p><strong>trn_aucs</strong> – training matrices</p></li>
<li><p><strong>val_aucs</strong> – validation metrics</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>figure handle
ax:  figure axis</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plothist1d">
<span class="sig-name descname"><span class="pre">plothist1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plothist1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plothist1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Histogram observables in 1D</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plotvar">
<span class="sig-name descname"><span class="pre">plotvar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NBINS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plotvar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plotvar" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a single variable.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.plots.plotvars">
<span class="sig-name descname"><span class="pre">plotvars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VARS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NBINS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">70</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/plots.html#plotvars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.plots.plotvars" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all variables.</p>
</dd></dl>

</div>
<div class="section" id="module-icenet.tools.prints">
<span id="icenet-tools-prints"></span><h3>icenet.tools.prints<a class="headerlink" href="#module-icenet.tools.prints" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.colored_row">
<span class="sig-name descname"><span class="pre">colored_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'green'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inactive_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#colored_row"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.colored_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Color vector elements.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.print_colored_matrix">
<span class="sig-name descname"><span class="pre">print_colored_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#print_colored_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.print_colored_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Print matrix with two colors (suitable for binary matrices).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.print_flow">
<span class="sig-name descname"><span class="pre">print_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#print_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.print_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a cut or infoflows.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.print_variables">
<span class="sig-name descname"><span class="pre">print_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VARS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#print_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.print_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Print in a format (# samples x # dimensions)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.printbar">
<span class="sig-name descname"><span class="pre">printbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#printbar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.printbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Print bar.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.printbranch">
<span class="sig-name descname"><span class="pre">printbranch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#printbranch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.printbranch" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a branch.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.set_arr_format">
<span class="sig-name descname"><span class="pre">set_arr_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#set_arr_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.set_arr_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Set numpy array print format.</p>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="iceplot.html" class="btn btn-neutral float-right" title="iceplot" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="iceid.html" class="btn btn-neutral float-left" title="iceid" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Mikael Mieskolainen, Blackett Laboratory, Imperial College London.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>