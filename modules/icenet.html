
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>icenet &#8212; icenet alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="iceplot" href="iceplot.html" />
    <link rel="prev" title="iceid" href="iceid.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="icenet">
<h1>icenet<a class="headerlink" href="#icenet" title="Permalink to this heading">¶</a></h1>
<p>Core classes including deep learning, data structures, manipulations and visualizations.</p>
<section id="icenet-algo">
<h2>icenet.algo<a class="headerlink" href="#icenet-algo" title="Permalink to this heading">¶</a></h2>
<p>Various (classic) algorithms.</p>
<section id="module-icenet.algo.analytic">
<span id="icenet-algo-analytic"></span><h3>icenet.algo.analytic<a class="headerlink" href="#module-icenet.algo.analytic" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.analytic.fox_wolfram_boost_inv">
<span class="sig-name descname"><span class="pre">fox_wolfram_boost_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/analytic.html#fox_wolfram_boost_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.analytic.fox_wolfram_boost_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>arxiv.org/pdf/1508.03144, (Formula 5.6)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – list of 4-momentum vectors</p></li>
<li><p><strong>L</strong> – maximum angular moment order</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of moments of order 0,1,…,L</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>S</p>
</dd>
</dl>
<p>[untested function]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.analytic.gram_matrix">
<span class="sig-name descname"><span class="pre">gram_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dot'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/analytic.html#gram_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.analytic.gram_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Gram matrix for 4-vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Array (list of N) of 4-vectors</p></li>
<li><p><strong>type</strong> – Type of Lorentz scalars computed (‘dot’, ‘s’, ‘t’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gram matrix (NxN)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>G</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.analytic.ktmetric">
<span class="sig-name descname"><span class="pre">ktmetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kt2_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt2_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dR2_ij</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/analytic.html#ktmetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.analytic.ktmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>kt-algorithm type distance measure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kt2_i</strong> – Particle 1 pt squared</p></li>
<li><p><strong>kt2_j</strong> – Particle 2 pt squared</p></li>
<li><p><strong>delta2_ij</strong> – Angular seperation between particles squared (deta**2 + dphi**2)</p></li>
<li><p><strong>R</strong> – Radius parameter</p></li>
<li><p><strong>1</strong> (<em>p =</em>) – (p=1) kt-like, (p=0) Cambridge/Aachen, (p=-1) anti-kt like</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>distance measure</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-icenet.algo.flr">
<span id="icenet-algo-flr"></span><h3>icenet.algo.flr<a class="headerlink" href="#module-icenet.algo.flr" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.flr.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_pdfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_pdfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/flr.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.flr.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the likelihood ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – input data [# vectors x # dimensions]</p></li>
<li><p><strong>b_pdfs</strong> – background pdfs</p></li>
<li><p><strong>s_pdfs</strong> – signal pdfs</p></li>
<li><p><strong>bin_edges</strong> – bin edges</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>likelihood ratio</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>LR</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.flr.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/flr.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.flr.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorized likelihood classifier training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – input data [# vectors x # dimensions]</p></li>
<li><p><strong>y</strong> – target data</p></li>
<li><p><strong>weights</strong> – weighted events</p></li>
<li><p><strong>param</strong> – dictionary for the parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>background pdfs
s_pdfs:    signal pdfs
bin_edges: histogram bin edges</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>b_pdfs</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-icenet.algo.nmf">
<span id="icenet-algo-nmf"></span><h3>icenet.algo.nmf<a class="headerlink" href="#module-icenet.algo.nmf" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.nmf.ML_nmf">
<span class="sig-name descname"><span class="pre">ML_nmf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/nmf.html#ML_nmf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.nmf.ML_nmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-negative matrix factorization main function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> – (d x n) array (dimension x samples)</p></li>
<li><p><strong>k</strong> – number of components</p></li>
<li><p><strong>threshold</strong> – relative error threshold (Frob norm)</p></li>
<li><p><strong>maxiter</strong> – maximum number of iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(d x k) array of basis elements
H: (k x n) array of weights for each observations</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>W</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.nmf.ML_update_H">
<span class="sig-name descname"><span class="pre">ML_update_H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/nmf.html#ML_update_H"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.nmf.ML_update_H" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplicative (EM-type)
non-negative matrix factorization update for the expansion weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> – (d x n) (dimension x samples)</p></li>
<li><p><strong>W</strong> – (d x k) (dimension x dictionary size)</p></li>
<li><p><strong>H</strong> – (k x n) (expansion weights for each sample)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(k x n) array of updated weights for each sample</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.algo.nmf.ML_update_W">
<span class="sig-name descname"><span class="pre">ML_update_W</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/algo/nmf.html#ML_update_W"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.algo.nmf.ML_update_W" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplicative (EM-type)
non-negative matrix factorization update for basis components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> – (d x n) (dimension x samples)</p></li>
<li><p><strong>W</strong> – (d x k) (dimension x dictionary size)</p></li>
<li><p><strong>H</strong> – (k x n) (expansion weights for each sample)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(d x k) updated non-negative basis compoments</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>W</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="icenet-deep">
<h2>icenet.deep<a class="headerlink" href="#icenet-deep" title="Permalink to this heading">¶</a></h2>
<p>Deep learning model classes.</p>
<section id="module-icenet.deep.bnaf">
<span id="icenet-deep-bnaf"></span><h3>icenet.deep.bnaf<a class="headerlink" href="#module-icenet.deep.bnaf" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.BNAF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BNAF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#BNAF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.BNAF" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that extends <code class="docutils literal notranslate"><span class="pre">torch.nn.Sequential</span></code> for constructing a Block Neural
Normalizing Flow.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.BNAF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#BNAF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.BNAF.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>torch.Tensor</strong> – </p></li>
<li><p><strong>tensor.</strong> (<em>required. The input</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output tensor and the log-det-Jacobian of this transformation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.MaskedWeight">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaskedWeight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#MaskedWeight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.MaskedWeight" title="Permalink to this definition">¶</a></dt>
<dd><p>Module that implements a linear layer with block matrices with positive diagonal blocks.
Moreover, it uses Weight Normalization (<a class="reference external" href="https://arxiv.org/abs/1602.07868">https://arxiv.org/abs/1602.07868</a>) for stability.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.MaskedWeight.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#MaskedWeight.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.MaskedWeight.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, required. The input tensor.</p></li>
<li><p><strong>grad</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, optional.</p></li>
<li><p><strong>transformations.</strong> (<em>The log diagonal block of the partial Jacobian of previous</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output tensor and the log diagonal blocks of the partial log-Jacobian of previous
transformations combined with this transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.MaskedWeight.get_weights">
<span class="sig-name descname"><span class="pre">get_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#MaskedWeight.get_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.MaskedWeight.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the weight matrix using masks and weight normalization.
It also compute the log diagonal blocks of it.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.bnaf.MaskedWeight.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.bnaf.MaskedWeight.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Permutation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Permutation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Permutation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Module that outputs a permutation of its input.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Permutation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Permutation.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Permutation.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, required. The input tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The permuted tensor and the log-det-Jacobian of this permutation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Permutation.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.bnaf.Permutation.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Sequential">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Sequential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Sequential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Sequential" title="Permalink to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Sequential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" title="(in Python v3.10)"><span class="pre">OrderedDict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Class that extends <code class="docutils literal notranslate"><span class="pre">torch.nn.Sequential</span></code> for computing the output of
the function together with the log-det-Jacobian of such transformation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Sequential.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Sequential.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Sequential.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>torch.Tensor</strong> – </p></li>
<li><p><strong>tensor.</strong> (<em>required. The input</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output tensor and the log-det-Jacobian of this transformation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Tanh">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Tanh</span></span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Tanh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that extends <code class="docutils literal notranslate"><span class="pre">torch.nn.Tanh</span></code> additionally computing the log diagonal
blocks of the Jacobian.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Tanh.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/bnaf.html#Tanh.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.bnaf.Tanh.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, required. The input tensor.</p></li>
<li><p><strong>grad</strong> – <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, optional.</p></li>
<li><p><strong>transformations.</strong> (<em>The log diagonal blocks of the partial Jacobian of previous</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output tensor and the log diagonal blocks of the partial log-Jacobian of previous
transformations combined with this transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.bnaf.Tanh.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.bnaf.Tanh.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-icenet.deep.cnn">
<span id="icenet-deep-cnn"></span><h3>icenet.deep.cnn<a class="headerlink" href="#module-icenet.deep.cnn" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_cnn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_mlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.cnn.CNN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CNN_DMAX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nchannels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_cnn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_mlp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN_DMAX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX" title="Permalink to this definition">¶</a></dt>
<dd><p>Dual (simultaneous) input network [image tensors x global vectors]</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN_DMAX.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Input data dictionary with members</dt><dd><p>‘x’ : as image tensor
‘u’’ : global feature tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX.maxout">
<span class="sig-name descname"><span class="pre">maxout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN_DMAX.maxout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX.maxout" title="Permalink to this definition">¶</a></dt>
<dd><p>MAXOUT layer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/cnn.html#CNN_DMAX.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.cnn.CNN_DMAX.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.cnn.CNN_DMAX.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-icenet.deep.dbnf">
<span id="icenet-deep-dbnf"></span><h3>icenet.deep.dbnf<a class="headerlink" href="#module-icenet.deep.dbnf" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.dbnf.Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.Dataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.compute_log_p_x">
<span class="sig-name descname"><span class="pre">compute_log_p_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#compute_log_p_x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.compute_log_p_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Model log-likelihood: log [ prod_{j=1}^N pdf(x_j)], where x ~ (iid) pdf(x)</p>
<p>log p(x) = log p(z) + sum_{k=1}^K log|det J_{f_k}|</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model object</p></li>
<li><p><strong>x</strong> – N minibatch vectors</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>log-likelihood value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.create_model">
<span class="sig-name descname"><span class="pre">create_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngseed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#create_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.create_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the network object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>param</strong> – parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.get_pdf">
<span class="sig-name descname"><span class="pre">get_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#get_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.get_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate learned density (pdf) at point x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model object</p></li>
<li><p><strong>x</strong> – input vector(s)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pdf value</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>&gt; x = torch.tensor([[1.0, 2.0]])
&gt; l = get_pdf(model,x)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.load_models">
<span class="sig-name descname"><span class="pre">load_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeldir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#load_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.load_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Load models from files</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>2-class density ratio pdf(x,S) / pdf(x,B) for each vector x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param</strong> – input parameters</p></li>
<li><p><strong>X</strong> – pytorch tensor of vectors</p></li>
<li><p><strong>models</strong> – list of model objects</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>log-likelihood ratio</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>LLR</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dbnf.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trn_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trn_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeldir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dbnf.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dbnf.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the model density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – initialized model object</p></li>
<li><p><strong>optimizer</strong> – optimizer object</p></li>
<li><p><strong>scheduler</strong> – optimization scheduler</p></li>
<li><p><strong>trn_x</strong> – training vectors</p></li>
<li><p><strong>val_x</strong> – validation vectors</p></li>
<li><p><strong>trn_weights</strong> – training weights</p></li>
<li><p><strong>param</strong> – parameters</p></li>
<li><p><strong>modeldir</strong> – directory to save the model</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-icenet.deep.deps">
<span id="icenet-deep-deps"></span><h3>icenet.deep.deps<a class="headerlink" href="#module-icenet.deep.deps" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DEPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#DEPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.DEPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation equivariant networks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS.binarypredict">
<span class="sig-name descname"><span class="pre">binarypredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#DEPS.binarypredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.DEPS.binarypredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#DEPS.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.DEPS.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#DEPS.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.DEPS.softpredict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.DEPS.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.DEPS.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_max">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PEN1_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN1_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN1_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation Equivariant Network (PEN) max-type layers.</p>
<p>Single dimensional model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_max.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN1_max.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN1_max.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_max.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.PEN1_max.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_mean">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PEN1_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN1_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN1_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation Equivariant Network (PEN) mean-type layers.</p>
<p>Single dimensional model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_mean.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN1_mean.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN1_mean.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN1_mean.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.PEN1_mean.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_max">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PEN_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation Equivariant Network (PEN) max-type layers.</p>
<p>Multidimensional model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_max.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN_max.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN_max.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_max.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.PEN_max.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_mean">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PEN_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Permutation Equivariant Network (PEN) mean-type layers.</p>
<p>Multidimensional model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_mean.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/deps.html#PEN_mean.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.deps.PEN_mean.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.deps.PEN_mean.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.deps.PEN_mean.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="icenet-deep-dmlp">
<h3>icenet.deep.dmlp<a class="headerlink" href="#icenet-deep-dmlp" title="Permalink to this heading">¶</a></h3>
</section>
<section id="module-icenet.deep.dopt">
<span id="icenet-deep-dopt"></span><h3>icenet.deep.dopt<a class="headerlink" href="#module-icenet.deep.dopt" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.dopt.Dataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#Dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.Dataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.dopt.DualDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DualDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#DualDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.DualDataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.log_softmax">
<span class="sig-name descname"><span class="pre">log_softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#log_softmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.log_softmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Log of softmax</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – network output without softmax</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>logsoftmax values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.log_sum_exp">
<span class="sig-name descname"><span class="pre">log_sum_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#log_sum_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.log_sum_exp" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://timvieira.github.io/blog/post/2014/02/11/exp-normalize-trick/">http://timvieira.github.io/blog/post/2014/02/11/exp-normalize-trick/</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.logsumexp">
<span class="sig-name descname"><span class="pre">logsumexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#logsumexp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.logsumexp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.model_to_cuda">
<span class="sig-name descname"><span class="pre">model_to_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#model_to_cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.model_to_cuda" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to handle CPU/GPU setup</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.multiclass_cross_entropy">
<span class="sig-name descname"><span class="pre">multiclass_cross_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#multiclass_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.multiclass_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Per instance weighted cross entropy loss
(negative log-likelihood)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.multiclass_cross_entropy_logprob">
<span class="sig-name descname"><span class="pre">multiclass_cross_entropy_logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_phat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#multiclass_cross_entropy_logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.multiclass_cross_entropy_logprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Per instance weighted cross entropy loss
(negative log-likelihood)</p>
<p>Numerically more stable version.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.multiclass_focal_entropy">
<span class="sig-name descname"><span class="pre">multiclass_focal_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#multiclass_focal_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.multiclass_focal_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Per instance weighted ‘focal entropy loss’
<a class="reference external" href="https://arxiv.org/pdf/1708.02002.pdf">https://arxiv.org/pdf/1708.02002.pdf</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.multiclass_focal_entropy_logprob">
<span class="sig-name descname"><span class="pre">multiclass_focal_entropy_logprob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_phat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#multiclass_focal_entropy_logprob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.multiclass_focal_entropy_logprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Per instance weighted ‘focal entropy loss’
<a class="reference external" href="https://arxiv.org/pdf/1708.02002.pdf">https://arxiv.org/pdf/1708.02002.pdf</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_trn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_trn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trn_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modeldir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Main training loop</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.weights_init_all">
<span class="sig-name descname"><span class="pre">weights_init_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_funcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#weights_init_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.weights_init_all" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<p>model = MyNet()
weights_init_all(model, init_funcs)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.weights_init_normal">
<span class="sig-name descname"><span class="pre">weights_init_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#weights_init_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.weights_init_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes module weights from normal distribution
with a rule sigma ~ 1/sqrt(n)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.deep.dopt.weights_init_uniform_rule">
<span class="sig-name descname"><span class="pre">weights_init_uniform_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/dopt.html#weights_init_uniform_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.dopt.weights_init_uniform_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes module weights from uniform [-a,a]</p>
</dd></dl>

</section>
<section id="module-icenet.deep.gcnn">
<span id="icenet-deep-gcnn"></span><h3>icenet.deep.gcnn<a class="headerlink" href="#module-icenet.deep.gcnn" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph Convolution Network</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.gcnn.GCN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN_layer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GCN_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph Convolution Network Layer</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN_layer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN_layer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN_layer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward operator</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN_layer.reset_param">
<span class="sig-name descname"><span class="pre">reset_param</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/gcnn.html#GCN_layer.reset_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.gcnn.GCN_layer.reset_param" title="Permalink to this definition">¶</a></dt>
<dd><p>1 / sqrt(N) normalization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.gcnn.GCN_layer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.gcnn.GCN_layer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="icenet-deep-graph">
<h3>icenet.deep.graph<a class="headerlink" href="#icenet-deep-graph" title="Permalink to this heading">¶</a></h3>
</section>
<section id="module-icenet.deep.maxo">
<span id="icenet-deep-maxo"></span><h3>icenet.deep.maxo<a class="headerlink" href="#module-icenet.deep.maxo" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MAXOUT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neurons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT" title="Permalink to this definition">¶</a></dt>
<dd><p>MAXOUT network</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.binarypredict">
<span class="sig-name descname"><span class="pre">binarypredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT.binarypredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.binarypredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return max probability class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.maxout">
<span class="sig-name descname"><span class="pre">maxout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT.maxout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.maxout" title="Permalink to this definition">¶</a></dt>
<dd><p>MAXOUT layer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/maxo.html#MAXOUT.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.softpredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Softmax probability</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.maxo.MAXOUT.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.maxo.MAXOUT.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-icenet.deep.mlgr">
<span id="icenet-deep-mlgr"></span><h3>icenet.deep.mlgr<a class="headerlink" href="#module-icenet.deep.mlgr" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MLGR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/mlgr.html#MLGR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.mlgr.MLGR" title="Permalink to this definition">¶</a></dt>
<dd><p>Multinomial Logistic Regression model</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR.binarypredict">
<span class="sig-name descname"><span class="pre">binarypredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/mlgr.html#MLGR.binarypredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.mlgr.MLGR.binarypredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return maximum probability class</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/mlgr.html#MLGR.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.mlgr.MLGR.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR.softpredict">
<span class="sig-name descname"><span class="pre">softpredict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/mlgr.html#MLGR.softpredict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.mlgr.MLGR.softpredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Softmax probability</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.mlgr.MLGR.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.mlgr.MLGR.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="icenet-deep-pgraph">
<h3>icenet.deep.pgraph<a class="headerlink" href="#icenet-deep-pgraph" title="Permalink to this heading">¶</a></h3>
</section>
<section id="icenet-deep-predict">
<h3>icenet.deep.predict<a class="headerlink" href="#icenet-deep-predict" title="Permalink to this heading">¶</a></h3>
</section>
<section id="module-icenet.deep.tempscale">
<span id="icenet-deep-tempscale"></span><h3>icenet.deep.tempscale<a class="headerlink" href="#module-icenet.deep.tempscale" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.deep.tempscale.ModelWithTemperature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ModelWithTemperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/tempscale.html#ModelWithTemperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.tempscale.ModelWithTemperature" title="Permalink to this definition">¶</a></dt>
<dd><p>“Temperate calibration” wrapper class.</p>
<p>Output of the original network needs to be in logits,
not softmax or log softmax.</p>
<p>Functions expects model(input) to return logits.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.tempscale.ModelWithTemperature.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/tempscale.html#ModelWithTemperature.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.tempscale.ModelWithTemperature.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.tempscale.ModelWithTemperature.set_temperature">
<span class="sig-name descname"><span class="pre">set_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">valid_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/tempscale.html#ModelWithTemperature.set_temperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.tempscale.ModelWithTemperature.set_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune the tempearature of the model with NLL loss (using the validation set)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>valid_loader</strong> – validation set loader (DataLoader)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.deep.tempscale.ModelWithTemperature.temperature_scale">
<span class="sig-name descname"><span class="pre">temperature_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/deep/tempscale.html#ModelWithTemperature.temperature_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.deep.tempscale.ModelWithTemperature.temperature_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform temperature scaling on logits</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="icenet.deep.tempscale.ModelWithTemperature.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#icenet.deep.tempscale.ModelWithTemperature.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="icenet-deep-train">
<h3>icenet.deep.train<a class="headerlink" href="#icenet-deep-train" title="Permalink to this heading">¶</a></h3>
</section>
</section>
<section id="icenet-optim">
<h2>icenet.optim<a class="headerlink" href="#icenet-optim" title="Permalink to this heading">¶</a></h2>
<p>Custom optimization functions.</p>
<section id="module-icenet.optim.adam">
<span id="icenet-optim-adam"></span><h3>icenet.optim.adam<a class="headerlink" href="#module-icenet.optim.adam" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.optim.adam.Adam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Adam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.9,</span> <span class="pre">0.999)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amsgrad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adam.html#Adam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adam.Adam" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adam.Adam.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adam.html#Adam.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adam.Adam.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single optimization step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>closure</strong> (<em>callable</em><em>, </em><em>optional</em>) – A closure that reevaluates the model
and returns the loss.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adam.Adam.substitute">
<span class="sig-name descname"><span class="pre">substitute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adam.html#Adam.substitute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adam.Adam.substitute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adam.Adam.swap">
<span class="sig-name descname"><span class="pre">swap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adam.html#Adam.swap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adam.Adam.swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Swapping the running average of params and the current params for saving parameters using polyak averaging</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-icenet.optim.adamax">
<span id="icenet-optim-adamax"></span><h3>icenet.optim.adamax<a class="headerlink" href="#module-icenet.optim.adamax" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.optim.adamax.Adamax">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Adamax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.002</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.9,</span> <span class="pre">0.999)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adamax.html#Adamax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adamax.Adamax" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adamax.Adamax.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adamax.html#Adamax.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adamax.Adamax.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single optimization step (parameter update).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>closure</strong> (<em>callable</em>) – A closure that reevaluates the model and
returns the loss. Optional for most optimizers.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unless otherwise specified, this function should not modify the
<code class="docutils literal notranslate"><span class="pre">.grad</span></code> field of the parameters.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adamax.Adamax.substitute">
<span class="sig-name descname"><span class="pre">substitute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adamax.html#Adamax.substitute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adamax.Adamax.substitute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.adamax.Adamax.swap">
<span class="sig-name descname"><span class="pre">swap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/adamax.html#Adamax.swap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.adamax.Adamax.swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Swapping the running average of params and the current params for saving parameters using polyak averaging</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-icenet.optim.scheduler">
<span id="icenet-optim-scheduler"></span><h3>icenet.optim.scheduler<a class="headerlink" href="#module-icenet.optim.scheduler" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.optim.scheduler.ReduceLROnPlateau">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ReduceLROnPlateau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/scheduler.html#ReduceLROnPlateau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.scheduler.ReduceLROnPlateau" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="icenet.optim.scheduler.ReduceLROnPlateau.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_best</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback_reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/optim/scheduler.html#ReduceLROnPlateau.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.optim.scheduler.ReduceLROnPlateau.step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
<section id="icenet-tools">
<h2>icenet.tools<a class="headerlink" href="#icenet-tools" title="Permalink to this heading">¶</a></h2>
<p>Tool and auxiliary functions.</p>
<section id="module-icenet.tools.aux">
<span id="icenet-tools-aux"></span><h3>icenet.tools.aux<a class="headerlink" href="#module-icenet.tools.aux" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.aux.Metric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_soft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mva_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#Metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.Metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifier performance evaluation metrics.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.arrays2matrix">
<span class="sig-name descname"><span class="pre">arrays2matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_binedges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_binedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#arrays2matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.arrays2matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Array representation summed to matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_arr</strong> – array of [x values]</p></li>
<li><p><strong>y_arr</strong> – array of [y values]</p></li>
<li><p><strong>z_arr</strong> – array of [z values]</p></li>
<li><p><strong>x_binedges</strong> – array of binedges</p></li>
<li><p><strong>y_binedges</strong> – array of binedges</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrix output</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.bin2int">
<span class="sig-name descname"><span class="pre">bin2int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#bin2int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.bin2int" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary vector to integer.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.bin_array">
<span class="sig-name descname"><span class="pre">bin_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#bin_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.bin_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a positive integer num into an N-bit bit vector.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binaryvec2int">
<span class="sig-name descname"><span class="pre">binaryvec2int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binaryvec2int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binaryvec2int" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a matrix of binary vectors row-by-row into integer reps.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binom_coeff_all">
<span class="sig-name descname"><span class="pre">binom_coeff_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAX</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binom_coeff_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binom_coeff_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum all all binomial coefficients up to MAX.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binomial">
<span class="sig-name descname"><span class="pre">binomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Binomial coefficient C(n,k).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binvec2powersetindex">
<span class="sig-name descname"><span class="pre">binvec2powersetindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binvec2powersetindex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binvec2powersetindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary vector to powerset index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – matrix of binary vectors [# number of vectors x dimension]</p></li>
<li><p><strong>B</strong> – the powerset matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of powerset indices</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.binvec_are_equal">
<span class="sig-name descname"><span class="pre">binvec_are_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#binvec_are_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.binvec_are_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare equality of two binary vectors a and b.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – binary vectors</p></li>
<li><p><strong>b</strong> – binary vectors</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p>true or false</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.count_targets">
<span class="sig-name descname"><span class="pre">count_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entrystart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entrystop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#count_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.count_targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Targets statistics printout</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>events</strong> – uproot object</p></li>
<li><p><strong>ids</strong> – list of branch identifiers</p></li>
<li><p><strong>entrystart</strong> – uproot starting point</p></li>
<li><p><strong>entrystop</strong> – uproot ending point</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Printout on stdout</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.create_model_filename">
<span class="sig-name descname"><span class="pre">create_model_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#create_model_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.create_model_filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.deltaphi">
<span class="sig-name descname"><span class="pre">deltaphi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#deltaphi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.deltaphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Deltaphi measure.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.deltar">
<span class="sig-name descname"><span class="pre">deltar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#deltar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.deltar" title="Permalink to this definition">¶</a></dt>
<dd><p>DeltaR measure.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.generatebinary">
<span class="sig-name descname"><span class="pre">generatebinary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#generatebinary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.generatebinary" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate all 2**N binary vectors (as boolean matrix rows)
with 1 &lt;= M &lt;= N number of ones (hot bits) (default N)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.generatebinary_fixed">
<span class="sig-name descname"><span class="pre">generatebinary_fixed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#generatebinary_fixed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.generatebinary_fixed" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all combinations of n bits with fixed k ones.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.hardclass">
<span class="sig-name descname"><span class="pre">hardclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_soft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#hardclass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.hardclass" title="Permalink to this definition">¶</a></dt>
<dd><p>Soft decision to hard decision at point (valrange[1] - valrange[0]) / 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y_soft</strong> – probabilities for two classes</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>classification results</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y_out</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.int2onehot">
<span class="sig-name descname"><span class="pre">int2onehot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#int2onehot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.int2onehot" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer class vector to class “one-hot encoding”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> – Class indices (# samples)</p></li>
<li><p><strong>N_classes</strong> – Number of classes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Onehot representation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>onehot</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.jagged2tensor">
<span class="sig-name descname"><span class="pre">jagged2tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_binedges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_binedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#jagged2tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.jagged2tensor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – input data (samples x dimensions) with jagged structure</p></li>
<li><p><strong>ids</strong> – all variable names</p></li>
<li><p><strong>xyz</strong> – array of (x,y,z) channel triplet strings such as [[‘image_clu_eta’, ‘image_clu_phi’, ‘image_clu_e’]]</p></li>
<li><p><strong>x_binedges</strong> – </p></li>
<li><p><strong>y_binedges</strong> – arrays of bin edges</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor of size (samples x channels x rows x columns)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>T</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.longvec2matrix">
<span class="sig-name descname"><span class="pre">longvec2matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#longvec2matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.longvec2matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>A matrix representation / dimension converter function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input matrix</p></li>
<li><p><strong>M</strong> – Number of set elements</p></li>
<li><p><strong>D</strong> – Feature dimension</p></li>
<li><p><strong>order</strong> – Reshape direction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Y</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>X = [# number of samples N ] x [# M x D long feature vectors]
–&gt;
Y = [# number of samples N ] x [# number of set elements M] x [# vector dimension D]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.los2lol">
<span class="sig-name descname"><span class="pre">los2lol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">listOsets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#los2lol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.los2lol" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of sets [{},{},..,{}] to a list of of lists [[], [], …, []].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.merge_connected">
<span class="sig-name descname"><span class="pre">merge_connected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#merge_connected"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.merge_connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge sets with common elements (find connected graphs problem).</p>
<p class="rubric">Examples</p>
<p>Input:  [{0, 1}, {0, 1}, {2, 3}, {2, 3}, {4, 5}, {4, 5}, {6, 7}, {6, 7}, {8, 9}, {8, 9}, {10}, {11}]
Output: [{0, 1}, {2, 3}, {4, 5}, {6, 7}, {8, 9}, {10}, {11}]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.multiclass_roc_auc_score">
<span class="sig-name descname"><span class="pre">multiclass_roc_auc_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_soft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'macro'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#multiclass_roc_auc_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.multiclass_roc_auc_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiclass AUC (area under the curve).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> – True classifications</p></li>
<li><p><strong>y_soft</strong> – Soft probabilities</p></li>
<li><p><strong>weights</strong> – Sample weights</p></li>
<li><p><strong>average</strong> – Averaging strategy</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Area under the curve via averaging</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>auc</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.number_of_set_bits">
<span class="sig-name descname"><span class="pre">number_of_set_bits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#number_of_set_bits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.number_of_set_bits" title="Permalink to this definition">¶</a></dt>
<dd><p>Return how many bits are active of an integer in a standard binary representation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.pick_ind">
<span class="sig-name descname"><span class="pre">pick_ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#pick_ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.pick_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return indices between minmax[0] &lt;= x &lt; minmax[1], i.e. [a,b)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input vector</p></li>
<li><p><strong>minmax</strong> – Minimum and maximum values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>indices</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator which returns approx equally sized chunks.
:param a: Total number
:param n: Number of chunks</p>
<p class="rubric">Example</p>
<p>list(split(10, 3))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.split_start_end">
<span class="sig-name descname"><span class="pre">split_start_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#split_start_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.split_start_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns approx equally sized chunks.
:param a: Total number
:param n: Number of chunks</p>
<p class="rubric">Example</p>
<p>list(split(10, 3))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.to_edges">
<span class="sig-name descname"><span class="pre">to_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#to_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.to_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>treat <cite>l</cite> as a Graph and returns it’s edges</p>
<p class="rubric">Examples</p>
<p>to_edges([‘a’,’b’,’c’,’d’]) -&gt; [(a,b), (b,c),(c,d)]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.to_graph">
<span class="sig-name descname"><span class="pre">to_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#to_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.to_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn the list into a graph.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.weight2onehot">
<span class="sig-name descname"><span class="pre">weight2onehot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_classes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#weight2onehot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.weight2onehot" title="Permalink to this definition">¶</a></dt>
<dd><p>Weights into one-hot encoding.
:param weights: array of weights
:param Y: targets
:param N_classes: number of classes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux.x2ind">
<span class="sig-name descname"><span class="pre">x2ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux.html#x2ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux.x2ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return histogram bin indices for data in x, which needs to be an array [].
:param x: data to be classified between bin edges
:param binedges: histogram bin edges</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>histogram bin indices</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>inds</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-icenet.tools.aux_torch">
<span id="icenet-tools-aux-torch"></span><h3>icenet.tools.aux_torch<a class="headerlink" href="#module-icenet.tools.aux_torch" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux_torch.load_torch_checkpoint">
<span class="sig-name descname"><span class="pre">load_torch_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mynet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux_torch.html#load_torch_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux_torch.load_torch_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pytorch checkpoint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – folder path</p></li>
<li><p><strong>label</strong> – model label name</p></li>
<li><p><strong>epoch</strong> – epoch index. Use -1 for the last epoch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pytorch model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux_torch.load_torch_model">
<span class="sig-name descname"><span class="pre">load_torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_start_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux_torch.html#load_torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux_torch.load_torch_model" title="Permalink to this definition">¶</a></dt>
<dd><p>PyTorch model loader</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.aux_torch.save_torch_model">
<span class="sig-name descname"><span class="pre">save_torch_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/aux_torch.html#save_torch_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.aux_torch.save_torch_model" title="Permalink to this definition">¶</a></dt>
<dd><p>PyTorch model saver</p>
</dd></dl>

</section>
<section id="module-icenet.tools.icemap">
<span id="icenet-tools-icemap"></span><h3>icenet.tools.icemap<a class="headerlink" href="#module-icenet.tools.icemap" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.icemap.icemap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">icemap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icemap.html#icemap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icemap.icemap" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data                [N vectors x … x D dimensions]</p></li>
<li><p><strong>ids</strong> – variable names      [D strings]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.icemap.test_icecube_concat">
<span class="sig-name descname"><span class="pre">test_icecube_concat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icemap.html#test_icecube_concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icemap.test_icecube_concat" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit tests</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.icemap.test_icecube_indexing">
<span class="sig-name descname"><span class="pre">test_icecube_indexing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icemap.html#test_icecube_indexing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icemap.test_icecube_indexing" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit tests</p>
</dd></dl>

</section>
<section id="module-icenet.tools.iceroot">
<span id="icenet-tools-iceroot"></span><h3>icenet.tools.iceroot<a class="headerlink" href="#module-icenet.tools.iceroot" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.iceroot.load_tree">
<span class="sig-name descname"><span class="pre">load_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/iceroot.html#load_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.iceroot.load_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Load ROOT files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rootfile</strong> – </p></li>
<li><p><strong>tree</strong> – </p></li>
<li><p><strong>entry_start</strong> – </p></li>
<li><p><strong>entry_stop</strong> – </p></li>
<li><p><strong>ids</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.iceroot.load_tree_stats">
<span class="sig-name descname"><span class="pre">load_tree_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/iceroot.html#load_tree_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.iceroot.load_tree_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-icenet.tools.icevec">
<span id="icenet-tools-icevec"></span><h3>icenet.tools.icevec<a class="headerlink" href="#module-icenet.tools.icevec" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.icevec.hepmc2vec4">
<span class="sig-name descname"><span class="pre">hepmc2vec4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#hepmc2vec4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.hepmc2vec4" title="Permalink to this definition">¶</a></dt>
<dd><p>HepMC3 python binding FourVector to vec4</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vec4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4" title="Permalink to this definition">¶</a></dt>
<dd><p>Lorentz vectors</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.abs_delta_phi">
<span class="sig-name descname"><span class="pre">abs_delta_phi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.abs_delta_phi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.abs_delta_phi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.abseta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">abseta</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.abseta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.beta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">beta</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.beta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.boost">
<span class="sig-name descname"><span class="pre">boost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.boost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.boost" title="Permalink to this definition">¶</a></dt>
<dd><p>Lorentz boost
:param b: Boost 4-momentum (e.g. system)</p>
<blockquote>
<div><p>sign : 1 or -1 (direction of the boost, into the rest (-1) or out (1))</p>
</div></blockquote>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.costheta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">costheta</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.costheta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.deltaR">
<span class="sig-name descname"><span class="pre">deltaR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.deltaR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.deltaR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.deltaphi">
<span class="sig-name descname"><span class="pre">deltaphi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.deltaphi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.deltaphi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.dot3">
<span class="sig-name descname"><span class="pre">dot3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.dot3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.dot3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.dot4">
<span class="sig-name descname"><span class="pre">dot4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.dot4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.dot4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.e">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.e" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.eta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eta</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.eta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.gamma">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gamma</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.m">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.m" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.m2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">m2</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.m2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.mt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mt</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.mt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.p3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p3</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.p3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.p3mod">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p3mod</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.p3mod" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.p3mod2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p3mod2</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.p3mod2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.phi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phi</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.phi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.phi_PIPI">
<span class="sig-name descname"><span class="pre">phi_PIPI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.phi_PIPI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.phi_PIPI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.pt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pt</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.pt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.pt2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pt2</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.pt2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.px">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">px</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.px" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.py">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">py</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.py" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.pz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pz</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.pz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.rapidity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rapidity</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.rapidity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.rotateSO3">
<span class="sig-name descname"><span class="pre">rotateSO3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.rotateSO3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.rotateSO3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.rotateX">
<span class="sig-name descname"><span class="pre">rotateX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.rotateX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.rotateX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.rotateY">
<span class="sig-name descname"><span class="pre">rotateY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.rotateY"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.rotateY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.rotateZ">
<span class="sig-name descname"><span class="pre">rotateZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.rotateZ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.rotateZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setE">
<span class="sig-name descname"><span class="pre">setE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setMagThetaPhi">
<span class="sig-name descname"><span class="pre">setMagThetaPhi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setMagThetaPhi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setMagThetaPhi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setP3">
<span class="sig-name descname"><span class="pre">setP3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setP3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setP3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setPt2RapPhiM2">
<span class="sig-name descname"><span class="pre">setPt2RapPhiM2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setPt2RapPhiM2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setPt2RapPhiM2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setPtEtaPhi">
<span class="sig-name descname"><span class="pre">setPtEtaPhi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setPtEtaPhi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setPtEtaPhi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setPtEtaPhiM">
<span class="sig-name descname"><span class="pre">setPtEtaPhiM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setPtEtaPhiM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setPtEtaPhiM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setPxPyPzE">
<span class="sig-name descname"><span class="pre">setPxPyPzE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setPxPyPzE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setPxPyPzE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setX">
<span class="sig-name descname"><span class="pre">setX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setXYZ">
<span class="sig-name descname"><span class="pre">setXYZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setXYZ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setXYZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setXYZM">
<span class="sig-name descname"><span class="pre">setXYZM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setXYZM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setXYZM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setXYZT">
<span class="sig-name descname"><span class="pre">setXYZT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setXYZT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setXYZT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setY">
<span class="sig-name descname"><span class="pre">setY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setY"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.setZ">
<span class="sig-name descname"><span class="pre">setZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/icevec.html#vec4.setZ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.icevec.vec4.setZ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.t">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.theta">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.theta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.x">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.y">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.y" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="icenet.tools.icevec.vec4.z">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#icenet.tools.icevec.vec4.z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-icenet.tools.io">
<span id="icenet-tools-io"></span><h3>icenet.tools.io<a class="headerlink" href="#module-icenet.tools.io" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.io.DATASET">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DATASET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngseed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#DATASET"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.DATASET" title="Permalink to this definition">¶</a></dt>
<dd><p>Main class for datasets</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.io.Data">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#Data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.Data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data                [N vectors x D dimensions]</p></li>
<li><p><strong>y</strong> – target output data  [N vectors]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.Data.classfilter">
<span class="sig-name descname"><span class="pre">classfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#Data.classfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.Data.classfilter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.apply_madscore">
<span class="sig-name descname"><span class="pre">apply_madscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_mad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#apply_madscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.apply_madscore" title="Permalink to this definition">¶</a></dt>
<dd><p>MAD-score normalization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.apply_zscore">
<span class="sig-name descname"><span class="pre">apply_zscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#apply_zscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.apply_zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Z-score normalization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.apply_zscore_tensor">
<span class="sig-name descname"><span class="pre">apply_zscore_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#apply_zscore_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.apply_zscore_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply z-score normalization for tensors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.calc_madscore">
<span class="sig-name descname"><span class="pre">calc_madscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#calc_madscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.calc_madscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate robust normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Input with [# vectors x # dimensions]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median vector
X_mad : Median deviation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>X_m</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.calc_zscore">
<span class="sig-name descname"><span class="pre">calc_zscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#calc_zscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.calc_zscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 0-mean &amp; unit-variance normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – Input with [# vectors x # dimensions]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mean vector
X_std : Standard deviation vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>X_mu</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.calc_zscore_tensor">
<span class="sig-name descname"><span class="pre">calc_zscore_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#calc_zscore_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.calc_zscore_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute z-score normalization for tensors.
:param T: input tensor data (events x channels x rows x cols, …)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>mu, std tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.checkinfnan">
<span class="sig-name descname"><span class="pre">checkinfnan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#checkinfnan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.checkinfnan" title="Permalink to this definition">¶</a></dt>
<dd><p>Check inf and Nan values and replace with a default value.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fastarray1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">capacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1" title="Permalink to this definition">¶</a></dt>
<dd><p>1D pre-memory occupied buffer arrays for histogramming etc.</p>
<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="icenet.tools.io.fastarray1.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#fastarray1.values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.fastarray1.values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.get_gpu_memory_map">
<span class="sig-name descname"><span class="pre">get_gpu_memory_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#get_gpu_memory_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.get_gpu_memory_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the GPU VRAM use in GB.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary with keys as device ids [integers]
and values the memory used by the GPU.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.glob_expand_files">
<span class="sig-name descname"><span class="pre">glob_expand_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datapath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#glob_expand_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.glob_expand_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Do global / brace expansion of files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> – dataset filename with glob syntax</p></li>
<li><p><strong>datapath</strong> – path to files</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>full filenames including the path</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>files</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.impute_data">
<span class="sig-name descname"><span class="pre">impute_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imputer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">999]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iterative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#impute_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.impute_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Data imputation (treatment of missing values, Nan and Inf).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input data matrix [N vectors x D dimensions]</p></li>
<li><p><strong>imputer</strong> – Pre-trained imputator, default None</p></li>
<li><p><strong>dim</strong> – Array of active dimensions to impute</p></li>
<li><p><strong>values</strong> – List of special integer values indicating the need for imputation</p></li>
<li><p><strong>labels</strong> – List containing textual description of input variables</p></li>
<li><p><strong>algorithm</strong> – ‘constant’, mean’, ‘median’, ‘iterative’, knn_k’</p></li>
<li><p><strong>knn_k</strong> – knn k-nearest neighbour parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Imputed output data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>X</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.pick_vars">
<span class="sig-name descname"><span class="pre">pick_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#icenet.tools.io.DATASET" title="icenet.tools.io.DATASET"><span class="pre">DATASET</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_of_variables</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#pick_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.pick_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose the active set of input variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.process_memory_use">
<span class="sig-name descname"><span class="pre">process_memory_use</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#process_memory_use"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.process_memory_use" title="Permalink to this definition">¶</a></dt>
<dd><p>Return system memory (RAM) used by the process in GB.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.showmem">
<span class="sig-name descname"><span class="pre">showmem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#showmem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.showmem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.split_data">
<span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rngseed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.split_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Split into [A = train &amp; validation] + [B = test] sets</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.io.torch_cuda_total_memory">
<span class="sig-name descname"><span class="pre">torch_cuda_total_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/io.html#torch_cuda_total_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.io.torch_cuda_total_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Return CUDA device VRAM available in GB.</p>
</dd></dl>

</section>
<section id="icenet-tools-plots">
<h3>icenet.tools.plots<a class="headerlink" href="#icenet-tools-plots" title="Permalink to this heading">¶</a></h3>
</section>
<section id="module-icenet.tools.prints">
<span id="icenet-tools-prints"></span><h3>icenet.tools.prints<a class="headerlink" href="#module-icenet.tools.prints" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.colored_row">
<span class="sig-name descname"><span class="pre">colored_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'green'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inactive_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#colored_row"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.colored_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Color vector elements.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.print_colored_matrix">
<span class="sig-name descname"><span class="pre">print_colored_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#print_colored_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.print_colored_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Print matrix with two colors (suitable for binary matrices).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.print_flow">
<span class="sig-name descname"><span class="pre">print_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#print_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.print_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a cut or infoflows.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.print_variables">
<span class="sig-name descname"><span class="pre">print_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#print_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.print_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Print in a format (# samples x # dimensions)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.printbar">
<span class="sig-name descname"><span class="pre">printbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">75</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#printbar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.printbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Print bar.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.printbranch">
<span class="sig-name descname"><span class="pre">printbranch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#printbranch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.printbranch" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a branch.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.prints.set_arr_format">
<span class="sig-name descname"><span class="pre">set_arr_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">precision</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/prints.html#set_arr_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.prints.set_arr_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Set numpy array print format.</p>
</dd></dl>

</section>
<section id="icenet-tools-process">
<h3>icenet.tools.process<a class="headerlink" href="#icenet-tools-process" title="Permalink to this heading">¶</a></h3>
</section>
<section id="module-icenet.tools.reweight">
<span id="icenet-tools-reweight"></span><h3>icenet.tools.reweight<a class="headerlink" href="#module-icenet.tools.reweight" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.reweight.balanceweights">
<span class="sig-name descname"><span class="pre">balanceweights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights_doublet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/reweight.html#balanceweights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.reweight.balanceweights" title="Permalink to this definition">¶</a></dt>
<dd><p>Balance N-class weights to sum to equal counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights_doublet</strong> – N-class event weights (events x classes)</p></li>
<li><p><strong>reference_class</strong> – which class gives the reference (integer)</p></li>
<li><p><strong>y</strong> – class targets</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights doublet with new weights per event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.reweight.compute_ND_reweights">
<span class="sig-name descname"><span class="pre">compute_ND_reweights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/reweight.html#compute_ND_reweights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.reweight.compute_ND_reweights" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-dim reweighting coefficients (currently 2D or 1D supported)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – training data input</p></li>
<li><p><strong>y</strong> – training data labels</p></li>
<li><p><strong>ids</strong> – variable names of columns of x</p></li>
<li><p><strong>args</strong> – arguments object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of re-weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>weights</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.reweight.pdf_1D_hist">
<span class="sig-name descname"><span class="pre">pdf_1D_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binedges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/reweight.html#pdf_1D_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.reweight.pdf_1D_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute re-weighting 1D pdfs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.reweight.pdf_2D_hist">
<span class="sig-name descname"><span class="pre">pdf_2D_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binedges_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binedges_B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/reweight.html#pdf_2D_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.reweight.pdf_2D_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute re-weighting 2D pdfs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.reweight.reweight_1D">
<span class="sig-name descname"><span class="pre">reweight_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/reweight.html#reweight_1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.reweight.reweight_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-class density reweighting coefficients.
:param X: Input data (# samples)
:param pdf: Dictionary of pdfs for each class
:param y: Class target data (# samples)
:param N_class: Number of classes
:param reference_class: Target class of re-weighting</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>weights for each event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.reweight.reweightcoeff1D">
<span class="sig-name descname"><span class="pre">reweightcoeff1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/reweight.html#reweightcoeff1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.reweight.reweightcoeff1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-class density reweighting coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Observable of interest (N x 1)</p></li>
<li><p><strong>y</strong> – Class labels (0,1,…) (N x 1)</p></li>
<li><p><strong>pdf</strong> – PDF for each class</p></li>
<li><p><strong>N_class</strong> – Number of classes</p></li>
<li><p><strong>equal_frac</strong> – equalize class fractions</p></li>
<li><p><strong>reference_class</strong> – e.g. 0 (background) or 1 (signal)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights for each event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.reweight.reweightcoeff2D">
<span class="sig-name descname"><span class="pre">reweightcoeff2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/reweight.html#reweightcoeff2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.reweight.reweightcoeff2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-class density reweighting coefficients.</p>
<p>Operates in full 2D without factorization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_A</strong> – Observable A of interest (N x 1)</p></li>
<li><p><strong>X_B</strong> – Observable B of interest (N x 1)</p></li>
<li><p><strong>y</strong> – Signal (1) and background (0) labels (N x 1)</p></li>
<li><p><strong>pdf</strong> – Density histograms for each class</p></li>
<li><p><strong>N_class</strong> – Number of classes</p></li>
<li><p><strong>reference_class</strong> – e.g. Background (0) or signal (1)</p></li>
<li><p><strong>equal_frac</strong> – Equalize class fractions</p></li>
<li><p><strong>max_reg</strong> – Regularize the maximum reweight coefficient</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights for each event</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.reweight.reweightcoeff2DFP">
<span class="sig-name descname"><span class="pre">reweightcoeff2DFP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/reweight.html#reweightcoeff2DFP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.reweight.reweightcoeff2DFP" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute N-class density reweighting coefficients.</p>
<p>Operates in 2D with FACTORIZED PRODUCT marginal 1D distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_A</strong> – Observable of interest (N x 1)</p></li>
<li><p><strong>X_B</strong> – Observable of interest (N x 1)</p></li>
<li><p><strong>y</strong> – Signal (1) and background (0) targets</p></li>
<li><p><strong>pdf_A</strong> – Density of observable A</p></li>
<li><p><strong>pdf_B</strong> – Density of observable B</p></li>
<li><p><strong>N_class</strong> – Number of classes</p></li>
<li><p><strong>reference_class</strong> – e.g. 0 (background) or 1 (signal)</p></li>
<li><p><strong>equal_frac</strong> – Equalize integrated class fractions</p></li>
<li><p><strong>max_reg</strong> – Maximum weight regularization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights for each event</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-icenet.tools.stx">
<span id="icenet-tools-stx"></span><h3>icenet.tools.stx<a class="headerlink" href="#module-icenet.tools.stx" title="Permalink to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.apply_cutflow">
<span class="sig-name descname"><span class="pre">apply_cutflow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcorr_flow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#apply_cutflow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.apply_cutflow" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply cutflow</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cut</strong> – list of pre-calculated cuts, each list element is a boolean array</p></li>
<li><p><strong>names</strong> – list of names (description of each cut, for printout only)</p></li>
<li><p><strong>xcorr_flow</strong> – compute full N-point correlations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of indices, 1 = pass, 0 = fail</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ind</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.construct_columnar_cuts">
<span class="sig-name descname"><span class="pre">construct_columnar_cuts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutlist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#construct_columnar_cuts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.construct_columnar_cuts" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct cuts and corresponding names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Input columnar data matrix</p></li>
<li><p><strong>ids</strong> – Variable names for each column of X</p></li>
<li><p><strong>cutlist</strong> – Selection cuts as strings, such as [‘ABS__eta &lt; 0.5’, ‘trgbit == True’]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cuts, names</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.construct_exptree">
<span class="sig-name descname"><span class="pre">construct_exptree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#construct_exptree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.construct_exptree" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an expression (syntax) tree via recursion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>root</strong> – List of lists, for example
[[‘10’, ‘&gt;’, ‘7’], ‘AND’, [[‘4’, ‘&gt;=’, ‘2’], ‘AND’, [‘2’, ‘&lt;=’, ‘4’]]]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an expression tree object with ‘tree_node’ objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.eval_boolean_exptree">
<span class="sig-name descname"><span class="pre">eval_boolean_exptree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#eval_boolean_exptree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.eval_boolean_exptree" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluation of a (boolean) expression tree via recursion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> – expression tree object</p></li>
<li><p><strong>X</strong> – data matrix (N events x D dimensions)</p></li>
<li><p><strong>ids</strong> – variable names for each D dimension</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>boolean selection list of size N</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.eval_boolean_syntax">
<span class="sig-name descname"><span class="pre">eval_boolean_syntax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#eval_boolean_syntax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.eval_boolean_syntax" title="Permalink to this definition">¶</a></dt>
<dd><p>A complete wrapper to evaluate boolean syntax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> – boolean expression string, e.g. “pt &gt; 7.0 AND (x &lt; 2 OR x &gt;= 4)”</p></li>
<li><p><strong>X</strong> – input data (N x dimensions)</p></li>
<li><p><strong>ids</strong> – variable names as a list</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>boolean list of size N</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.parse_boolean_exptree">
<span class="sig-name descname"><span class="pre">parse_boolean_exptree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instring</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#parse_boolean_exptree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.parse_boolean_exptree" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean expression tree parser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>instring</strong> – input string, e.g. “pt &gt; 7.0 AND (x &lt; 2 OR x &gt;= 4)”</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A syntax tree as a list of lists</p>
</dd>
</dl>
<dl class="simple">
<dt>Information:</dt><dd><dl class="simple">
<dt>See: <a class="reference external" href="https://stackoverflow.com/questions/11133339/">https://stackoverflow.com/questions/11133339/</a></dt><dd><p>parsing-a-complex-logical-expression-in-pyparsing-in-a-binary-tree-fashion</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.print_exptree">
<span class="sig-name descname"><span class="pre">print_exptree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#print_exptree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.print_exptree" title="Permalink to this definition">¶</a></dt>
<dd><p>Print out an expression tree object via recursion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>root</strong> – expression tree (object type)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.test_syntax_tree_flip">
<span class="sig-name descname"><span class="pre">test_syntax_tree_flip</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#test_syntax_tree_flip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.test_syntax_tree_flip" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit tests</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.test_syntax_tree_parsing">
<span class="sig-name descname"><span class="pre">test_syntax_tree_parsing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#test_syntax_tree_parsing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.test_syntax_tree_parsing" title="Permalink to this definition">¶</a></dt>
<dd><p>Unit tests</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icenet.tools.stx.test_syntax_tree_simple">
<span class="sig-name descname"><span class="pre">test_syntax_tree_simple</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#test_syntax_tree_simple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.test_syntax_tree_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Units tests</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="icenet.tools.stx.tree_node">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tree_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icenet/tools/stx.html#tree_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icenet.tools.stx.tree_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to represent the nodes of an expression tree.</p>
</dd></dl>

</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">icenet</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/markup.html">Markup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="icebrk.html">icebrk</a></li>
<li class="toctree-l1"><a class="reference internal" href="icefit.html">icefit</a></li>
<li class="toctree-l1"><a class="reference internal" href="iceid.html">iceid</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">icenet</a></li>
<li class="toctree-l1"><a class="reference internal" href="iceplot.html">iceplot</a></li>
<li class="toctree-l1"><a class="reference internal" href="icetrg.html">icetrg</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="iceid.html" title="previous chapter">iceid</a></li>
      <li>Next: <a href="iceplot.html" title="next chapter">iceplot</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Mikael Mieskolainen, Blackett Laboratory, Imperial College London.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/modules/icenet.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>