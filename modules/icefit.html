<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>icefit &mdash; icenet alpha documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=1f169f65"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="icehgcal" href="icehgcal.html" />
    <link rel="prev" title="icedqcd" href="icedqcd.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
              <div class="version">
                0.1.2.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#preliminaries-conda-installation">Preliminaries: Conda installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#pre-installed-cuda-paths-experimental">Pre-installed CUDA paths (EXPERIMENTAL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#automated-setup">Automated setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#initialize-the-environment">Initialize the environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#possible-problems">Possible problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#show-installation-paths-of-binaries">Show installation paths of binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#gpu-support-commands">GPU-support commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#htcondor-gpu-job-submission">HTCondor GPU job submission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#conda-virtual-environment-commands">Conda virtual environment commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/installation.html#c-library-versions">C-library versions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#basic-design-principles">Basic design principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#yaml-configuration-files">YAML-configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#folder-structure">Folder structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#ai-algorithms-and-models">AI-algorithms and models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#advanced-ml-training-technology">Advanced ML-training technology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#automated-selectors-and-combinatorics-for-distributions">Automated selectors and combinatorics for distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/introduction.html#sun-grid-engine-sge-htcondor-execution">Sun Grid Engine (SGE) / HTCondor execution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes/markup.html">Markup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="icebrem.html">icebrem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icebrem.html#module-icebrem.common">icebrem.common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icebrem.html#icebrem.common.load_root_file"><code class="docutils literal notranslate"><span class="pre">load_root_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrem.html#icebrem.common.process_root"><code class="docutils literal notranslate"><span class="pre">process_root()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrem.html#icebrem.common.splitfactor"><code class="docutils literal notranslate"><span class="pre">splitfactor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icebrk.html">icebrk</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#icebrk-common">icebrk.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#module-icebrk.cutstats">icebrk.cutstats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.cutstats.apply_cuts"><code class="docutils literal notranslate"><span class="pre">apply_cuts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.cutstats.collect_info_stats"><code class="docutils literal notranslate"><span class="pre">collect_info_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.cutstats.collect_mcinfo_stats"><code class="docutils literal notranslate"><span class="pre">collect_mcinfo_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.cutstats.init_stat_objects"><code class="docutils literal notranslate"><span class="pre">init_stat_objects()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.cutstats.triplet_cuts"><code class="docutils literal notranslate"><span class="pre">triplet_cuts()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#module-icebrk.fasthistos">icebrk.fasthistos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.fasthistos.initialize"><code class="docutils literal notranslate"><span class="pre">initialize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#module-icebrk.features">icebrk.features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.features.construct_new_branches"><code class="docutils literal notranslate"><span class="pre">construct_new_branches()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.features.generate_feature_names"><code class="docutils literal notranslate"><span class="pre">generate_feature_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.features.getdimension"><code class="docutils literal notranslate"><span class="pre">getdimension()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#module-icebrk.histos">icebrk.histos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.histos.calc_MC_observables"><code class="docutils literal notranslate"><span class="pre">calc_MC_observables()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.histos.calc_batch_MC_observables"><code class="docutils literal notranslate"><span class="pre">calc_batch_MC_observables()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.histos.calc_batch_observables"><code class="docutils literal notranslate"><span class="pre">calc_batch_observables()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.histos.calc_observables"><code class="docutils literal notranslate"><span class="pre">calc_observables()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.histos.pickle_files"><code class="docutils literal notranslate"><span class="pre">pickle_files()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#module-icebrk.loop">icebrk.loop</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.loop.hdf5_append"><code class="docutils literal notranslate"><span class="pre">hdf5_append()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.loop.hdf5_write_handles"><code class="docutils literal notranslate"><span class="pre">hdf5_write_handles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.loop.hist_flush"><code class="docutils literal notranslate"><span class="pre">hist_flush()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.loop.initarrays"><code class="docutils literal notranslate"><span class="pre">initarrays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.loop.poweranalysis"><code class="docutils literal notranslate"><span class="pre">poweranalysis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.loop.process"><code class="docutils literal notranslate"><span class="pre">process()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#module-icebrk.PDG">icebrk.PDG</a></li>
<li class="toctree-l2"><a class="reference internal" href="icebrk.html#module-icebrk.tools">icebrk.tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.construct_MC_tree"><code class="docutils literal notranslate"><span class="pre">construct_MC_tree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.construct_MC_truth"><code class="docutils literal notranslate"><span class="pre">construct_MC_truth()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.construct_input_vec"><code class="docutils literal notranslate"><span class="pre">construct_input_vec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.construct_kinematics"><code class="docutils literal notranslate"><span class="pre">construct_kinematics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.construct_output_vec"><code class="docutils literal notranslate"><span class="pre">construct_output_vec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.deltar_3"><code class="docutils literal notranslate"><span class="pre">deltar_3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.find_connected_triplets"><code class="docutils literal notranslate"><span class="pre">find_connected_triplets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.get_first_indices"><code class="docutils literal notranslate"><span class="pre">get_first_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.index_of_first_signal"><code class="docutils literal notranslate"><span class="pre">index_of_first_signal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.index_of_last_signal"><code class="docutils literal notranslate"><span class="pre">index_of_last_signal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icebrk.html#icebrk.tools.print_MC_event"><code class="docutils literal notranslate"><span class="pre">print_MC_event()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icedqcd.html">icedqcd</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icedqcd.html#module-icedqcd.common">icedqcd.common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.common.load_root_file"><code class="docutils literal notranslate"><span class="pre">load_root_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.common.process_root"><code class="docutils literal notranslate"><span class="pre">process_root()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.common.splitfactor"><code class="docutils literal notranslate"><span class="pre">splitfactor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icedqcd.html#module-icedqcd.deploy">icedqcd.deploy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.deploy.create_ID_label"><code class="docutils literal notranslate"><span class="pre">create_ID_label()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.deploy.f2s"><code class="docutils literal notranslate"><span class="pre">f2s()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.deploy.generate_cartesian_param"><code class="docutils literal notranslate"><span class="pre">generate_cartesian_param()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.deploy.get_predictor"><code class="docutils literal notranslate"><span class="pre">get_predictor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.deploy.process_data"><code class="docutils literal notranslate"><span class="pre">process_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.deploy.zscore_normalization"><code class="docutils literal notranslate"><span class="pre">zscore_normalization()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icedqcd.html#module-icedqcd.graphio">icedqcd.graphio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.graphio.parse_graph_data"><code class="docutils literal notranslate"><span class="pre">parse_graph_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icedqcd.html#module-icedqcd.limits">icedqcd.limits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.limits.create_limit_plots_vector"><code class="docutils literal notranslate"><span class="pre">create_limit_plots_vector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.limits.create_limit_tables"><code class="docutils literal notranslate"><span class="pre">create_limit_tables()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.limits.find_limits"><code class="docutils literal notranslate"><span class="pre">find_limits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.limits.limit_wrapper_dict"><code class="docutils literal notranslate"><span class="pre">limit_wrapper_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.limits.plot_brazil"><code class="docutils literal notranslate"><span class="pre">plot_brazil()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.limits.run_limits_vector"><code class="docutils literal notranslate"><span class="pre">run_limits_vector()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icedqcd.html#module-icedqcd.optimize">icedqcd.optimize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.optimize.find_filter"><code class="docutils literal notranslate"><span class="pre">find_filter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.optimize.func_binormal"><code class="docutils literal notranslate"><span class="pre">func_binormal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.optimize.func_binormal2"><code class="docutils literal notranslate"><span class="pre">func_binormal2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.optimize.optimize_selection"><code class="docutils literal notranslate"><span class="pre">optimize_selection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icedqcd.html#icedqcd.optimize.plot_ROC_fit"><code class="docutils literal notranslate"><span class="pre">plot_ROC_fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">icefit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.abcd">icefit.abcd</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.abcd.ABCD_2NLL"><code class="docutils literal notranslate"><span class="pre">ABCD_2NLL()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.abcd.ABCD_eq"><code class="docutils literal notranslate"><span class="pre">ABCD_eq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.abcd.ABCD_err"><code class="docutils literal notranslate"><span class="pre">ABCD_err()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.abcd.test_abcd"><code class="docutils literal notranslate"><span class="pre">test_abcd()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.commutator">icefit.commutator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.commutator.crv"><code class="docutils literal notranslate"><span class="pre">crv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.commutator.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.commutator.selection_A"><code class="docutils literal notranslate"><span class="pre">selection_A()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.commutator.selection_B"><code class="docutils literal notranslate"><span class="pre">selection_B()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.cortools">icefit.cortools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.H_score"><code class="docutils literal notranslate"><span class="pre">H_score()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.I_score"><code class="docutils literal notranslate"><span class="pre">I_score()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.bw2bins"><code class="docutils literal notranslate"><span class="pre">bw2bins()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.corrcoeff_weighted_torch"><code class="docutils literal notranslate"><span class="pre">corrcoeff_weighted_torch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.distance_corr"><code class="docutils literal notranslate"><span class="pre">distance_corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.distance_corr_torch"><code class="docutils literal notranslate"><span class="pre">distance_corr_torch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.freedman_diaconis_bin"><code class="docutils literal notranslate"><span class="pre">freedman_diaconis_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.gaussian_mutual_information"><code class="docutils literal notranslate"><span class="pre">gaussian_mutual_information()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.hacine_entropy_bin"><code class="docutils literal notranslate"><span class="pre">hacine_entropy_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.hacine_joint_entropy_bin"><code class="docutils literal notranslate"><span class="pre">hacine_joint_entropy_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.mutual_information"><code class="docutils literal notranslate"><span class="pre">mutual_information()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.optbins"><code class="docutils literal notranslate"><span class="pre">optbins()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.optbins2d"><code class="docutils literal notranslate"><span class="pre">optbins2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.pearson_corr"><code class="docutils literal notranslate"><span class="pre">pearson_corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.percentile_per_dim"><code class="docutils literal notranslate"><span class="pre">percentile_per_dim()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.prc_CI"><code class="docutils literal notranslate"><span class="pre">prc_CI()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.scott_bin"><code class="docutils literal notranslate"><span class="pre">scott_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.test_constant"><code class="docutils literal notranslate"><span class="pre">test_constant()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.cortools.test_gaussian"><code class="docutils literal notranslate"><span class="pre">test_gaussian()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.dequantize">icefit.dequantize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.dequantize.U"><code class="docutils literal notranslate"><span class="pre">U()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.dequantize.compute_ind"><code class="docutils literal notranslate"><span class="pre">compute_ind()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.dequantize.construct_icdf"><code class="docutils literal notranslate"><span class="pre">construct_icdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.dequantize.fast_loop"><code class="docutils literal notranslate"><span class="pre">fast_loop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.dequantize.iDQF"><code class="docutils literal notranslate"><span class="pre">iDQF()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.dequantize.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.em">icefit.em</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.em.EM_frac"><code class="docutils literal notranslate"><span class="pre">EM_frac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.em.gausspdf"><code class="docutils literal notranslate"><span class="pre">gausspdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.em.mixture_nll"><code class="docutils literal notranslate"><span class="pre">mixture_nll()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.em.test_EM"><code class="docutils literal notranslate"><span class="pre">test_EM()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.icelimit">icefit.icelimit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.icelimit.CL_single"><code class="docutils literal notranslate"><span class="pre">CL_single()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.icelimit.CL_single_asymptotic"><code class="docutils literal notranslate"><span class="pre">CL_single_asymptotic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.icelimit.CL_single_compute"><code class="docutils literal notranslate"><span class="pre">CL_single_compute()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.icelimit.LL_splusb"><code class="docutils literal notranslate"><span class="pre">LL_splusb()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.icelimit.asymptotic_uncertainty_CLs"><code class="docutils literal notranslate"><span class="pre">asymptotic_uncertainty_CLs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.icelimit.convolve_systematics"><code class="docutils literal notranslate"><span class="pre">convolve_systematics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.icelimit.test_limits_unit_test"><code class="docutils literal notranslate"><span class="pre">test_limits_unit_test()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.jacobian">icefit.jacobian</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.jacobian.get_full_hessian"><code class="docutils literal notranslate"><span class="pre">get_full_hessian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.jacobian.get_gradient"><code class="docutils literal notranslate"><span class="pre">get_gradient()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.jacobian.get_jacobian"><code class="docutils literal notranslate"><span class="pre">get_jacobian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.jacobian.observed_fisher_info"><code class="docutils literal notranslate"><span class="pre">observed_fisher_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.jacobian.test_dimension_interfaces"><code class="docutils literal notranslate"><span class="pre">test_dimension_interfaces()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.jacobian.test_hessians"><code class="docutils literal notranslate"><span class="pre">test_hessians()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.jacobian.test_jacobians"><code class="docutils literal notranslate"><span class="pre">test_jacobians()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.lognormal">icefit.lognormal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.lognormal.create_label"><code class="docutils literal notranslate"><span class="pre">create_label()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.lognormal.lognormal_param"><code class="docutils literal notranslate"><span class="pre">lognormal_param()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.lognormal.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.lognormal.rand_lognormal"><code class="docutils literal notranslate"><span class="pre">rand_lognormal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.lognormal.rand_powexp"><code class="docutils literal notranslate"><span class="pre">rand_powexp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.lognormal.test_accuracy"><code class="docutils literal notranslate"><span class="pre">test_accuracy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.lognormal.test_lognormal"><code class="docutils literal notranslate"><span class="pre">test_lognormal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.mantissa">icefit.mantissa</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mantissa.bits2digits"><code class="docutils literal notranslate"><span class="pre">bits2digits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mantissa.digits2bits"><code class="docutils literal notranslate"><span class="pre">digits2bits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mantissa.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mantissa.plots"><code class="docutils literal notranslate"><span class="pre">plots()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mantissa.reduce_mantissa_bits"><code class="docutils literal notranslate"><span class="pre">reduce_mantissa_bits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mantissa.reduce_mantissa_digits"><code class="docutils literal notranslate"><span class="pre">reduce_mantissa_digits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mantissa.round_sig"><code class="docutils literal notranslate"><span class="pre">round_sig()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.mine">icefit.mine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mine.MINENet"><code class="docutils literal notranslate"><span class="pre">MINENet</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mine.apply_mine"><code class="docutils literal notranslate"><span class="pre">apply_mine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mine.apply_mine_batched"><code class="docutils literal notranslate"><span class="pre">apply_mine_batched()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mine.compute_mine"><code class="docutils literal notranslate"><span class="pre">compute_mine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mine.estimate"><code class="docutils literal notranslate"><span class="pre">estimate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mine.sample_batch"><code class="docutils literal notranslate"><span class="pre">sample_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.mine.train_loop"><code class="docutils literal notranslate"><span class="pre">train_loop()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.peakfit">icefit.peakfit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.peakfit.fit_and_analyze"><code class="docutils literal notranslate"><span class="pre">fit_and_analyze()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.peakfit.fit_task"><code class="docutils literal notranslate"><span class="pre">fit_task()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.peakfit.fit_task_multi"><code class="docutils literal notranslate"><span class="pre">fit_task_multi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.peakfit.get_rootfiles_jpsi"><code class="docutils literal notranslate"><span class="pre">get_rootfiles_jpsi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.peakfit.group_systematics"><code class="docutils literal notranslate"><span class="pre">group_systematics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.peakfit.run_jpsi_peakfit"><code class="docutils literal notranslate"><span class="pre">run_jpsi_peakfit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.peakfit.run_jpsi_tagprobe"><code class="docutils literal notranslate"><span class="pre">run_jpsi_tagprobe()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.score">icefit.score</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.score.logL"><code class="docutils literal notranslate"><span class="pre">logL()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-icefit.statstools">icefit.statstools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.ADS"><code class="docutils literal notranslate"><span class="pre">ADS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.analytical_extreme_npdf"><code class="docutils literal notranslate"><span class="pre">analytical_extreme_npdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.clopper_pearson_err"><code class="docutils literal notranslate"><span class="pre">clopper_pearson_err()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.columnar_mask_efficiency"><code class="docutils literal notranslate"><span class="pre">columnar_mask_efficiency()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.cormat2covmat"><code class="docutils literal notranslate"><span class="pre">cormat2covmat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.correlation_matrix"><code class="docutils literal notranslate"><span class="pre">correlation_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.covmat2corrmat"><code class="docutils literal notranslate"><span class="pre">covmat2corrmat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.error_on_mu"><code class="docutils literal notranslate"><span class="pre">error_on_mu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.error_on_std"><code class="docutils literal notranslate"><span class="pre">error_on_std()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.geom_mean_2D"><code class="docutils literal notranslate"><span class="pre">geom_mean_2D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.mc_extreme_multivariate_npdf"><code class="docutils literal notranslate"><span class="pre">mc_extreme_multivariate_npdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.mc_extreme_npdf"><code class="docutils literal notranslate"><span class="pre">mc_extreme_npdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.p2zscore"><code class="docutils literal notranslate"><span class="pre">p2zscore()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.poisson_ratio"><code class="docutils literal notranslate"><span class="pre">poisson_ratio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.poisson_tail"><code class="docutils literal notranslate"><span class="pre">poisson_tail()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.prod_eprop"><code class="docutils literal notranslate"><span class="pre">prod_eprop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.ratio_eprop"><code class="docutils literal notranslate"><span class="pre">ratio_eprop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.test_efficiency_ratio"><code class="docutils literal notranslate"><span class="pre">test_efficiency_ratio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.test_extreme_npdf"><code class="docutils literal notranslate"><span class="pre">test_extreme_npdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.test_ratios"><code class="docutils literal notranslate"><span class="pre">test_ratios()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.tpratio_taylor"><code class="docutils literal notranslate"><span class="pre">tpratio_taylor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.weighted_binomial_err"><code class="docutils literal notranslate"><span class="pre">weighted_binomial_err()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#icefit.statstools.welch_ttest"><code class="docutils literal notranslate"><span class="pre">welch_ttest()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icehgcal.html">icehgcal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icehgcal.html#module-icehgcal.common">icehgcal.common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.common.load_root_file"><code class="docutils literal notranslate"><span class="pre">load_root_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.common.process_root"><code class="docutils literal notranslate"><span class="pre">process_root()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.common.process_tracklet_data"><code class="docutils literal notranslate"><span class="pre">process_tracklet_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.common.read_data_tracklet"><code class="docutils literal notranslate"><span class="pre">read_data_tracklet()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.common.splitfactor"><code class="docutils literal notranslate"><span class="pre">splitfactor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icehgcal.html#module-icehgcal.graphio">icehgcal.graphio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.graphio.compute_edge_attr"><code class="docutils literal notranslate"><span class="pre">compute_edge_attr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.graphio.get_node_features"><code class="docutils literal notranslate"><span class="pre">get_node_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.graphio.parse_graph_data_candidate"><code class="docutils literal notranslate"><span class="pre">parse_graph_data_candidate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.graphio.parse_graph_data_trackster"><code class="docutils literal notranslate"><span class="pre">parse_graph_data_trackster()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icehgcal.html#module-icehgcal.preprocess">icehgcal.preprocess</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.preprocess.compute_edges"><code class="docutils literal notranslate"><span class="pre">compute_edges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.preprocess.create_trackster_data"><code class="docutils literal notranslate"><span class="pre">create_trackster_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehgcal.html#icehgcal.preprocess.event_loop"><code class="docutils literal notranslate"><span class="pre">event_loop()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icehnl.html">icehnl</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icehnl.html#module-icehnl.common">icehnl.common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icehnl.html#icehnl.common.load_root_file"><code class="docutils literal notranslate"><span class="pre">load_root_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icehnl.html#icehnl.common.splitfactor"><code class="docutils literal notranslate"><span class="pre">splitfactor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iceid.html">iceid</a><ul>
<li class="toctree-l2"><a class="reference internal" href="iceid.html#module-iceid.common">iceid.common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="iceid.html#iceid.common.load_root_file"><code class="docutils literal notranslate"><span class="pre">load_root_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceid.html#iceid.common.splitfactor"><code class="docutils literal notranslate"><span class="pre">splitfactor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="iceid.html#module-iceid.graphio">iceid.graphio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="iceid.html#iceid.graphio.get_node_features"><code class="docutils literal notranslate"><span class="pre">get_node_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceid.html#iceid.graphio.parse_graph_data"><code class="docutils literal notranslate"><span class="pre">parse_graph_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceid.html#iceid.graphio.parse_tensor_data"><code class="docutils literal notranslate"><span class="pre">parse_tensor_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icemc.html">icemc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icemc.html#module-icemc.icemc">icemc.icemc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.Gamma2tau"><code class="docutils literal notranslate"><span class="pre">Gamma2tau()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.U"><code class="docutils literal notranslate"><span class="pre">U()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.annotate_heatmap"><code class="docutils literal notranslate"><span class="pre">annotate_heatmap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.outer_sim_loop"><code class="docutils literal notranslate"><span class="pre">outer_sim_loop()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.outer_sim_loop_2"><code class="docutils literal notranslate"><span class="pre">outer_sim_loop_2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.produce_acceptance_sim"><code class="docutils literal notranslate"><span class="pre">produce_acceptance_sim()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.randexp"><code class="docutils literal notranslate"><span class="pre">randexp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.randpow"><code class="docutils literal notranslate"><span class="pre">randpow()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.resonance_generator"><code class="docutils literal notranslate"><span class="pre">resonance_generator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.set_aspect_true_equal"><code class="docutils literal notranslate"><span class="pre">set_aspect_true_equal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.spherical_acceptance"><code class="docutils literal notranslate"><span class="pre">spherical_acceptance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.tau2Gamma"><code class="docutils literal notranslate"><span class="pre">tau2Gamma()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.test"><code class="docutils literal notranslate"><span class="pre">test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.test_toy_pt_spectrum"><code class="docutils literal notranslate"><span class="pre">test_toy_pt_spectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icemc.html#icemc.icemc.twobody"><code class="docutils literal notranslate"><span class="pre">twobody()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icenet.html">icenet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icenet.html#icenet-algo">icenet.algo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.algo.analytic">icenet.algo.analytic</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.algo.flr">icenet.algo.flr</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.algo.nmf">icenet.algo.nmf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icenet.html#icenet-deep">icenet.deep</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.autogradxgb">icenet.deep.autogradxgb</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.bnaf">icenet.deep.bnaf</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.cnn">icenet.deep.cnn</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.da">icenet.deep.da</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.dbnf">icenet.deep.dbnf</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.deeptools">icenet.deep.deeptools</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.deps">icenet.deep.deps</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.dmlp">icenet.deep.dmlp</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.fastkan">icenet.deep.fastkan</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.gcnn">icenet.deep.gcnn</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.graph">icenet.deep.graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.iceboost">icenet.deep.iceboost</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.losstools">icenet.deep.losstools</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.lzmlp">icenet.deep.lzmlp</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.maxo">icenet.deep.maxo</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.mlgr">icenet.deep.mlgr</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.optimize">icenet.deep.optimize</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.pgraph">icenet.deep.pgraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.predict">icenet.deep.predict</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.tempscale">icenet.deep.tempscale</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.train">icenet.deep.train</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.deep.vae">icenet.deep.vae</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icenet.html#icenet-optim">icenet.optim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.optim.adam">icenet.optim.adam</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.optim.adamax">icenet.optim.adamax</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.optim.scheduler">icenet.optim.scheduler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="icenet.html#icenet-tools">icenet.tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.aux_torch">icenet.tools.aux_torch</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.aux">icenet.tools.aux</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.icemap">icenet.tools.icemap</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.iceroot">icenet.tools.iceroot</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.icevec">icenet.tools.icevec</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.io">icenet.tools.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.plots">icenet.tools.plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.prints">icenet.tools.prints</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.process">icenet.tools.process</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.raytools">icenet.tools.raytools</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.reweight">icenet.tools.reweight</a></li>
<li class="toctree-l3"><a class="reference internal" href="icenet.html#module-icenet.tools.stx">icenet.tools.stx</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iceplot.html">iceplot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="iceplot.html#module-iceplot.iceplot">iceplot.iceplot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.binwidth"><code class="docutils literal notranslate"><span class="pre">binwidth()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.change2density_labels"><code class="docutils literal notranslate"><span class="pre">change2density_labels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.chi2_cost"><code class="docutils literal notranslate"><span class="pre">chi2_cost()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.colors"><code class="docutils literal notranslate"><span class="pre">colors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.create_axes"><code class="docutils literal notranslate"><span class="pre">create_axes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.edge2centerbins"><code class="docutils literal notranslate"><span class="pre">edge2centerbins()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.fuse_histograms"><code class="docutils literal notranslate"><span class="pre">fuse_histograms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.generate_colormap"><code class="docutils literal notranslate"><span class="pre">generate_colormap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.hist"><code class="docutils literal notranslate"><span class="pre">hist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.hist_filled_error"><code class="docutils literal notranslate"><span class="pre">hist_filled_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.hist_obj"><code class="docutils literal notranslate"><span class="pre">hist_obj()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.hist_to_density"><code class="docutils literal notranslate"><span class="pre">hist_to_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.hist_to_density_fullspace"><code class="docutils literal notranslate"><span class="pre">hist_to_density_fullspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.histhepdata"><code class="docutils literal notranslate"><span class="pre">histhepdata()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.histmc"><code class="docutils literal notranslate"><span class="pre">histmc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.hobj"><code class="docutils literal notranslate"><span class="pre">hobj</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.ordered_legend"><code class="docutils literal notranslate"><span class="pre">ordered_legend()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.plot_horizontal_line"><code class="docutils literal notranslate"><span class="pre">plot_horizontal_line()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.ratioerr"><code class="docutils literal notranslate"><span class="pre">ratioerr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.set_axis_ticks"><code class="docutils literal notranslate"><span class="pre">set_axis_ticks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.set_global_style"><code class="docutils literal notranslate"><span class="pre">set_global_style()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.stepspace"><code class="docutils literal notranslate"><span class="pre">stepspace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.superplot"><code class="docutils literal notranslate"><span class="pre">superplot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.test_iceplot"><code class="docutils literal notranslate"><span class="pre">test_iceplot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.tick_calc"><code class="docutils literal notranslate"><span class="pre">tick_calc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iceplot.html#iceplot.iceplot.tick_creator"><code class="docutils literal notranslate"><span class="pre">tick_creator()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icetrg.html">icetrg</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icetrg.html#module-icetrg.common">icetrg.common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icetrg.html#icetrg.common.load_root_file"><code class="docutils literal notranslate"><span class="pre">load_root_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icetrg.html#icetrg.common.process_root"><code class="docutils literal notranslate"><span class="pre">process_root()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icetrg.html#icetrg.common.splitfactor"><code class="docutils literal notranslate"><span class="pre">splitfactor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="icezee.html">icezee</a><ul>
<li class="toctree-l2"><a class="reference internal" href="icezee.html#module-icezee.common">icezee.common</a><ul>
<li class="toctree-l3"><a class="reference internal" href="icezee.html#icezee.common.load_helper"><code class="docutils literal notranslate"><span class="pre">load_helper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icezee.html#icezee.common.load_root_file"><code class="docutils literal notranslate"><span class="pre">load_root_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="icezee.html#icezee.common.splitfactor"><code class="docutils literal notranslate"><span class="pre">splitfactor()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">icenet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">icefit</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/icefit.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="icefit">
<h1>icefit<a class="headerlink" href="#icefit" title="Link to this heading">¶</a></h1>
<p>Binned and unbinned fitting functions, neural methods and statistical tools.</p>
<section id="module-icefit.abcd">
<span id="icefit-abcd"></span><h2>icefit.abcd<a class="headerlink" href="#module-icefit.abcd" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.abcd.ABCD_2NLL">
<span class="sig-name descname"><span class="pre">ABCD_2NLL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/abcd.html#ABCD_2NLL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.abcd.ABCD_2NLL" title="Link to this definition">¶</a></dt>
<dd><p>ABCD estimators negative log-likelihood function</p>
<p>DEFINITION: A = B x C / D</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>B</strong> – Measured event counts</p></li>
<li><p><strong>C</strong> – Measured event counts</p></li>
<li><p><strong>D</strong> – Measured event counts</p></li>
<li><p><strong>mu</strong> – Free parameters of the likelihood function</p></li>
<li><p><strong>mu_B</strong> – Free parameters of the likelihood function</p></li>
<li><p><strong>mu_D</strong> – Free parameters of the likelihood function</p></li>
<li><p><strong>parameters</strong><strong>)</strong> (<em>(</em><em>N.B. here number</em><em> of </em><em>measurements == number</em><em> of </em><em>free</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Model relation:</dt><dd><dl class="simple">
<dt>Ntot = mu*mu_B + mu_B + mu*mu_D + mu_D</dt><dd><p>= (A) + (B) + (C) + (D)</p>
</dd>
</dl>
</dd>
</dl>
<p>See e.g. <a class="reference external" href="https://twiki.cern.ch/twiki/pub/Main/ABCDMethod/ABCDGuide_draft18Oct18.pdf">https://twiki.cern.ch/twiki/pub/Main/ABCDMethod/ABCDGuide_draft18Oct18.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>-2logL</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.abcd.ABCD_eq">
<span class="sig-name descname"><span class="pre">ABCD_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/abcd.html#ABCD_eq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.abcd.ABCD_eq" title="Link to this definition">¶</a></dt>
<dd><p>Basic estimator formula for count in ‘A’ (signal domain)</p>
<p>Independent (X,Y) gives us the definition A = B x C / D</p>
<p>Y
<a href="#id1"><span class="problematic" id="id2">|</span></a>C | A
<a href="#id3"><span class="problematic" id="id4">|</span></a>—–
<a href="#id5"><span class="problematic" id="id6">|</span></a>D | B
0——&gt; X</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.abcd.ABCD_err">
<span class="sig-name descname"><span class="pre">ABCD_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'errorprop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/abcd.html#ABCD_err"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.abcd.ABCD_err" title="Link to this definition">¶</a></dt>
<dd><p>ABCD uncertainty (confidence interval) methods</p>
<p>DEFINITION: A = B x C / D</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> – input value</p></li>
<li><p><strong>c</strong> – input value</p></li>
<li><p><strong>d</strong> – input value</p></li>
<li><p><strong>method</strong> – ‘errorprop’, ‘poisson’, ‘bootstrap’, ‘likelihood’</p></li>
<li><p><strong>N</strong> – number of random samples for sampling based methods</p></li>
<li><p><strong>alpha</strong> – confidence level (‘errorprop’ fixed at CL68)</p></li>
<li><p><strong>lrange</strong> – likelihood scan range</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>confidence interval array (lower,upper)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.abcd.test_abcd">
<span class="sig-name descname"><span class="pre">test_abcd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/abcd.html#test_abcd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.abcd.test_abcd" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-icefit.commutator">
<span id="icefit-commutator"></span><h2>icefit.commutator<a class="headerlink" href="#module-icefit.commutator" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.commutator.crv">
<span class="sig-name descname"><span class="pre">crv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_L</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/commutator.html#crv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.commutator.crv" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.commutator.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/commutator.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.commutator.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.commutator.selection_A">
<span class="sig-name descname"><span class="pre">selection_A</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_CUT</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/commutator.html#selection_A"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.commutator.selection_A" title="Link to this definition">¶</a></dt>
<dd><p>Per event: Cut on Y and then get the min(X) object</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.commutator.selection_B">
<span class="sig-name descname"><span class="pre">selection_B</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_CUT</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/commutator.html#selection_B"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.commutator.selection_B" title="Link to this definition">¶</a></dt>
<dd><p>Per event: Get the min(X) object and then cut on Y</p>
</dd></dl>

</section>
<section id="module-icefit.cortools">
<span id="icefit-cortools"></span><h2>icefit.cortools<a class="headerlink" href="#module-icefit.cortools" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.H_score">
<span class="sig-name descname"><span class="pre">H_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#H_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.H_score" title="Link to this definition">¶</a></dt>
<dd><p>Shannon Entropy (log_e ~ nats units)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> – probability vector</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>entropy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.I_score">
<span class="sig-name descname"><span class="pre">I_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#I_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.I_score" title="Link to this definition">¶</a></dt>
<dd><p>Mutual information score (log_e ~ nats units)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C</strong> – (X,Y) 2D-histogram array with positive definite event counts</p></li>
<li><p><strong>normalized</strong> – return normalized version (None, ‘additive’, ‘multiplicative’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mutual information score</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.bw2bins">
<span class="sig-name descname"><span class="pre">bw2bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#bw2bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.bw2bins" title="Link to this definition">¶</a></dt>
<dd><p>Convert a histogram binwidth to number of bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data array</p></li>
<li><p><strong>bw</strong> – binwidth</p></li>
<li><p><strong>alpha</strong> – outlier percentile</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>number of bins, if something fails return 1</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.corrcoeff_weighted_torch">
<span class="sig-name descname"><span class="pre">corrcoeff_weighted_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#corrcoeff_weighted_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.corrcoeff_weighted_torch" title="Link to this definition">¶</a></dt>
<dd><p>Per event weighted linear Pearson 2x2 correlation matrix cf. torch.corrcoef()</p>
<p>(torch autograd compatible)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data (Nx1)</p></li>
<li><p><strong>y</strong> – data (Nx1)</p></li>
<li><p><strong>weights</strong> – event weights</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.distance_corr">
<span class="sig-name descname"><span class="pre">distance_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#distance_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.distance_corr" title="Link to this definition">¶</a></dt>
<dd><p>Distance correlation
<a class="reference external" href="https://en.wikipedia.org/wiki/Distance_correlation">https://en.wikipedia.org/wiki/Distance_correlation</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – arrays of values</p></li>
<li><p><strong>y</strong> – arrays of values</p></li>
<li><p><strong>weights</strong> – possible event weights</p></li>
<li><p><strong>alpha</strong> – confidence interval [alpha/2, 1-alpha/2] level</p></li>
<li><p><strong>n_bootstrap</strong> – number of percentile bootstrap samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>correlation coefficient [0,1], confidence interval</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.distance_corr_torch">
<span class="sig-name descname"><span class="pre">distance_corr_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#distance_corr_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.distance_corr_torch" title="Link to this definition">¶</a></dt>
<dd><p>Distance Correlation, complexity O(N^2)</p>
<p>(torch autograd compatible)</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Distance_correlation">https://en.wikipedia.org/wiki/Distance_correlation</a></p>
<p>See: <a class="reference external" href="https://dcor.readthedocs.io/en/latest/theory.html">https://dcor.readthedocs.io/en/latest/theory.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data (N x dim)</p></li>
<li><p><strong>y</strong> – data (N x dim), where dim can be the same or different than for x</p></li>
<li><p><strong>weights</strong> – event weights (not implemented)</p></li>
<li><p><strong>p</strong> – p-norm [0,inf] value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.freedman_diaconis_bin">
<span class="sig-name descname"><span class="pre">freedman_diaconis_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nbins'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#freedman_diaconis_bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.freedman_diaconis_bin" title="Link to this definition">¶</a></dt>
<dd><p>Freedman-Diaconis rule for a 1D-histogram bin width</p>
<p>D. Freedman &amp; P. Diaconis (1981)
“On the histogram as a density estimator: L2 theory”.</p>
<p>~ N**(-1/3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – array of 1D data</p></li>
<li><p><strong>mode</strong> – return ‘width’ or ‘nbins’</p></li>
<li><p><strong>alpha</strong> – outlier percentile</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.gaussian_mutual_information">
<span class="sig-name descname"><span class="pre">gaussian_mutual_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#gaussian_mutual_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.gaussian_mutual_information" title="Link to this definition">¶</a></dt>
<dd><p>Analytical 2D-Gaussian mutual information
using a correlation coefficient rho.</p>
<p>I(X1,X2) = H(X1) + H(X2) - H(X1,X2)
:param rho: correlation coefficient between (-1,1)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>mutual information</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.hacine_entropy_bin">
<span class="sig-name descname"><span class="pre">hacine_entropy_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nbins'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#hacine_entropy_bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.hacine_entropy_bin" title="Link to this definition">¶</a></dt>
<dd><p>Hacine-Gharbi et al.
“Low Bias Histogram-Based Estimation of Mutual Information for Feature Selection.”
Pattern Recognition Letters, 2012.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scott_bin</strong><strong>(</strong><strong>)</strong> (<em>See</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.hacine_joint_entropy_bin">
<span class="sig-name descname"><span class="pre">hacine_joint_entropy_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nbins'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#hacine_joint_entropy_bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.hacine_joint_entropy_bin" title="Link to this definition">¶</a></dt>
<dd><p>Hacine-Gharbi, Ravier. “A Binning Formula of Bi-histogram
for Joint Entropy Estimation Using Mean Square Error Minimization.”
Pattern Recognition Letters, 2018.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scott_bin</strong><strong>(</strong><strong>)</strong> (<em>See</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.mutual_information">
<span class="sig-name descname"><span class="pre">mutual_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">automethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Scott2D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#mutual_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.mutual_information" title="Link to this definition">¶</a></dt>
<dd><p>Mutual information entropy (non-linear measure of dependency)
between x and y variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – array of values</p></li>
<li><p><strong>y</strong> – array of values</p></li>
<li><p><strong>weights</strong> – weights (default None)</p></li>
<li><p><strong>bins_x</strong> – x binning array  If None, then automatic.</p></li>
<li><p><strong>bins_y</strong> – y binning array.</p></li>
<li><p><strong>normalized</strong> – normalize the mutual information (see I_score() function)</p></li>
<li><p><strong>n_bootstrap</strong> – number of percentile bootstrap samples</p></li>
<li><p><strong>alpha</strong> – bootstrap confidence interval</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Autobinning args:</dt><dd><p>automethod : ‘Hacine2D’, ‘Scott2D’
minbins    : minimum number of bins per dimension
outlier    : outlier protection percentile</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>mutual information, confidence interval</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.optbins">
<span class="sig-name descname"><span class="pre">optbins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxM</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nbins'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#optbins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.optbins" title="Link to this definition">¶</a></dt>
<dd><p>NOTE: Weak performance, study the method !!</p>
<p>Optimal 1D-histogram binning via Bayesian Brute Force search algorithm.</p>
<p>K.H Knuth, 2012, Entropy.
<a class="reference external" href="https://arxiv.org/abs/physics/0605197">https://arxiv.org/abs/physics/0605197</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data points</p></li>
<li><p><strong>maxM</strong> – maximum number of bins</p></li>
<li><p><strong>mode</strong> – “nbins” or “width”</p></li>
<li><p><strong>alpha</strong> – outlier protection percentile</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>optimal number of bins</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.optbins2d">
<span class="sig-name descname"><span class="pre">optbins2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(40,</span> <span class="pre">40)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nbins'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#optbins2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.optbins2d" title="Link to this definition">¶</a></dt>
<dd><p>NOTE: Weak performance, study the method !!</p>
<p>Optimal 2D-histogram binning via Bayesian Brute Force search algorithm.</p>
<p>K.H Knuth, 2012, Entropy.
<a class="reference external" href="https://arxiv.org/abs/physics/0605197">https://arxiv.org/abs/physics/0605197</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data points</p></li>
<li><p><strong>y</strong> – data points</p></li>
<li><p><strong>maxM</strong> – maximum number of bins per dimension</p></li>
<li><p><strong>mode</strong> – “nbins” or “width”</p></li>
<li><p><strong>alpha</strong> – outlier protection percentile</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>optimal number of bins</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.pearson_corr">
<span class="sig-name descname"><span class="pre">pearson_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_abs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#pearson_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.pearson_corr" title="Link to this definition">¶</a></dt>
<dd><p>Pearson Correlation Coefficient
<a class="reference external" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">https://en.wikipedia.org/wiki/Pearson_correlation_coefficient</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – arrays of values</p></li>
<li><p><strong>y</strong> – arrays of values</p></li>
<li><p><strong>weights</strong> – possible event weights</p></li>
<li><p><strong>return_abs</strong> – return absolute value</p></li>
<li><p><strong>alpha</strong> – confidence interval [alpha/2, 1-alpha/2] level</p></li>
<li><p><strong>n_bootstrap</strong> – number of percentile bootstrap samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>correlation coefficient [-1,1], confidence interval, p-value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.percentile_per_dim">
<span class="sig-name descname"><span class="pre">percentile_per_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#percentile_per_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.percentile_per_dim" title="Link to this definition">¶</a></dt>
<dd><p>Compute percentiles for each dimension (column) over samples (rows)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – (N x dim)</p></li>
<li><p><strong>q</strong> – percentile (0,100)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array with length dim</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.prc_CI">
<span class="sig-name descname"><span class="pre">prc_CI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#prc_CI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.prc_CI" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.scott_bin">
<span class="sig-name descname"><span class="pre">scott_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nbins'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#scott_bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.scott_bin" title="Link to this definition">¶</a></dt>
<dd><p>Scott rule for a 2D-histogram bin widths</p>
<p>Scott, D.W. (1992),
Multivariate Density Estimation: Theory, Practice, and Visualization – 2D-Gaussian case</p>
<p>~ N**(-1/4)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – array of 1D data (one dimension of the bivariate distribution)</p></li>
<li><p><strong>rho</strong> – Linear correlation coefficient</p></li>
<li><p><strong>mode</strong> – return ‘width’ or ‘nbins’</p></li>
<li><p><strong>alpha</strong> – outlier percentile</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.test_constant">
<span class="sig-name descname"><span class="pre">test_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#test_constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.test_constant" title="Link to this definition">¶</a></dt>
<dd><p>Constant input unit test of the estimators.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.cortools.test_gaussian">
<span class="sig-name descname"><span class="pre">test_gaussian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/cortools.html#test_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.cortools.test_gaussian" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian unit test of the estimators.</p>
</dd></dl>

</section>
<section id="module-icefit.dequantize">
<span id="icefit-dequantize"></span><h2>icefit.dequantize<a class="headerlink" href="#module-icefit.dequantize" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.dequantize.U">
<span class="sig-name descname"><span class="pre">U</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/dequantize.html#U"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.dequantize.U" title="Link to this definition">¶</a></dt>
<dd><p>Uniform random numbers between [a,b]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.dequantize.compute_ind">
<span class="sig-name descname"><span class="pre">compute_ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/dequantize.html#compute_ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.dequantize.compute_ind" title="Link to this definition">¶</a></dt>
<dd><p>Index association helper</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.dequantize.construct_icdf">
<span class="sig-name descname"><span class="pre">construct_icdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/dequantize.html#construct_icdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.dequantize.construct_icdf" title="Link to this definition">¶</a></dt>
<dd><p>Construct inverse CDF</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.dequantize.fast_loop">
<span class="sig-name descname"><span class="pre">fast_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_buffer:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deq:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta=&lt;class</span> <span class="pre">'numpy.ndarray'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_ind=&lt;class</span> <span class="pre">'numpy.ndarray'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/dequantize.html#fast_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.dequantize.fast_loop" title="Link to this definition">¶</a></dt>
<dd><p>Fast loop function used by iDQF</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.dequantize.iDQF">
<span class="sig-name descname"><span class="pre">iDQF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/dequantize.html#iDQF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.dequantize.iDQF" title="Link to this definition">¶</a></dt>
<dd><p>Dequantization via inverse CDF</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data sample array (1D)</p></li>
<li><p><strong>theta</strong> – (theoretical) quantized pdf x-values, if None, discrete pdf is estimated from x</p></li>
<li><p><strong>pvals</strong> – (theoretical) quantized pdf y-values, -||-</p></li>
<li><p><strong>N_buffer</strong> – technical buffer size</p></li>
<li><p><strong>n_interp</strong> – number of interpolation points</p></li>
<li><p><strong>kind</strong> – interpolation type, e.g. ‘linear’, ‘cubic’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dequantized x values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.dequantize.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/dequantize.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.dequantize.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-icefit.em">
<span id="icefit-em"></span><h2>icefit.em<a class="headerlink" href="#module-icefit.em" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.em.EM_frac">
<span class="sig-name descname"><span class="pre">EM_frac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/em.html#EM_frac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.em.EM_frac" title="Link to this definition">¶</a></dt>
<dd><p>EM-algorithm for unknown integrated class fractions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf</strong> – (n x K) density (pdf) values for n measurements, K classes</p></li>
<li><p><strong>iter</strong> – Number of iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Integrated class fractions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>frac</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.em.gausspdf">
<span class="sig-name descname"><span class="pre">gausspdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/em.html#gausspdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.em.gausspdf" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian pdf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.em.mixture_nll">
<span class="sig-name descname"><span class="pre">mixture_nll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/em.html#mixture_nll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.em.mixture_nll" title="Link to this definition">¶</a></dt>
<dd><p>Mixture model negative Log-Likelihood</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf</strong> – (n x K) density (pdf) values for n measurements, K classes</p></li>
<li><p><strong>frac</strong> – <ol class="upperalpha simple" start="11">
<li><p>class fractions with sum 1</p></li>
</ol>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Negative Log-Likelihood</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nll</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.em.test_EM">
<span class="sig-name descname"><span class="pre">test_EM</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/em.html#test_EM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.em.test_EM" title="Link to this definition">¶</a></dt>
<dd><p>Test function to test EM iteration</p>
</dd></dl>

</section>
<section id="module-icefit.icelimit">
<span id="icefit-icelimit"></span><h2>icefit.icelimit<a class="headerlink" href="#module-icefit.icelimit" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.icelimit.CL_single">
<span class="sig-name descname"><span class="pre">CL_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_hypothesis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_toys_pdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_syst_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_syst_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_syst_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_syst_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_CLs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/icelimit.html#CL_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.icelimit.CL_single" title="Link to this definition">¶</a></dt>
<dd><p>One tailed signal upper limits using “toy” Monte Carlo.</p>
<p>A single channel counting experiment case with “quasi-Bayesian” style systematics
convoluted in via MC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Signal strength parameter</p></li>
<li><p><strong>s_hypothesis</strong> – Number of predicted signal events (with mu = 1)</p></li>
<li><p><strong>bg_expected</strong> – Number of expected background events</p></li>
<li><p><strong>observed</strong> – Number of observed events</p></li>
<li><p><strong>num_toys_pdf</strong> – Number of MC samples to construct PDFs</p></li>
<li><p><strong>use_CLs</strong> – Return “CLs” type limits</p></li>
<li><p><strong>(</strong><strong>s</strong><strong>)</strong><strong>bg_syst_error</strong> – Systematic error on estimated (signal) background</p></li>
<li><p><strong>(</strong><strong>s</strong><strong>)</strong><strong>bg_error_type</strong> – Systematic uncertainty perturbation type (flat, normal, log-normal)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>p-value</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>For the “CLs” approach motivation, see: A. Read, “Presentation of search results: the CLs technique”
<a class="reference external" href="https://en.wikipedia.org/wiki/CLs_method_(particle_physics">https://en.wikipedia.org/wiki/CLs_method_(particle_physics</a>)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.icelimit.CL_single_asymptotic">
<span class="sig-name descname"><span class="pre">CL_single_asymptotic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_hypothesis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/icelimit.html#CL_single_asymptotic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.icelimit.CL_single_asymptotic" title="Link to this definition">¶</a></dt>
<dd><p>One tailed signal upper limits using asymptotic (Gaussian) approximation.</p>
<p>A single channel counting experiment case (without systematics –&gt; requires profile likelihood)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> – Signal strength parameter</p></li>
<li><p><strong>s_hypothesis</strong> – Number of predicted signal events (with mu = 1)</p></li>
<li><p><strong>bg_expected</strong> – Number of expected background events</p></li>
<li><p><strong>observed</strong> – Number of observed events</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>p-value</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Cowan et al, “Asymptotic formulae for likelihood-based tests of new physics”,
<a class="reference external" href="https://arxiv.org/abs/1007.1727">https://arxiv.org/abs/1007.1727</a></p>
<dl class="simple">
<dt><a class="reference external" href="https://indico.cern.ch/event/126652/contributions/1343592/">https://indico.cern.ch/event/126652/contributions/1343592/</a></dt><dd><p>attachments/80222/115004/Frequentist_Limit_Recommendation.pdf</p>
</dd>
</dl>
<p><a class="reference external" href="https://arxiv.org/abs/2102.04275">https://arxiv.org/abs/2102.04275</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.icelimit.CL_single_compute">
<span class="sig-name descname"><span class="pre">CL_single_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_hypothesis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_syst_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_syst_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'toys'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_toys_pdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_toys_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1e-05,</span> <span class="pre">10000.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'golden'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/icelimit.html#CL_single_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.icelimit.CL_single_compute" title="Link to this definition">¶</a></dt>
<dd><p>Main solver function for the upper limit computation on the signal strength parameter mu.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_hypothesis</strong> – expected signal count (with mu = 1)</p></li>
<li><p><strong>bg_expected</strong> – expected background count</p></li>
<li><p><strong>observed</strong> – observed event count, if None then observed = bg_expected</p></li>
<li><p><strong>method</strong> – ‘toys’ or ‘asymptotic’</p></li>
<li><p><strong>num_toys</strong> – number of MC samples for toys</p></li>
<li><p><strong>alpha</strong> – confidence level for the upper limit (e.g. 0.05 ~ CL95 upper limits)</p></li>
<li><p><strong>s_syst_error</strong> – systematic error size on signal</p></li>
<li><p><strong>bg_syst_error</strong> – systematic error size on background</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Optimization args:</dt><dd><p>mu_bounds:        bounds on mu-value to obey
mu_init:          initial value
max_restart:      maximum number of restarts
func_tol:         quadratic loss tolerance
optimize_method:  method to use for the optimization, ‘brent’ or ‘golden’
maxiter:          maximum number of iterations</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>upper limits [-2 sigma, 1 sigma, median, +1 sigma, +2 sigma] at the level alpha</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.icelimit.LL_splusb">
<span class="sig-name descname"><span class="pre">LL_splusb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/icelimit.html#LL_splusb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.icelimit.LL_splusb" title="Link to this definition">¶</a></dt>
<dd><p>Single channel Poisson log-likelihood</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – counts</p></li>
<li><p><strong>s</strong> – expected signal count (mean)</p></li>
<li><p><strong>b</strong> – expected background count (mean)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.icelimit.asymptotic_uncertainty_CLs">
<span class="sig-name descname"><span class="pre">asymptotic_uncertainty_CLs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/icelimit.html#asymptotic_uncertainty_CLs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.icelimit.asymptotic_uncertainty_CLs" title="Link to this definition">¶</a></dt>
<dd><p>Asymptotic (Asimov) +-N sigma values around median expected
N = 0 gives the median.</p>
<p>Type “CLs”, keeps the minus sigma tail on positive side of mu.
See reference: “Frequentist_Limit_Recommendation.pdf”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu_up</strong> – iteratively solved median expected upper limit value</p></li>
<li><p><strong>q</strong> – test statistic value corresponding to mu_up</p></li>
<li><p><strong>alpha</strong> – confidence level at which mu_up was extracted</p></li>
<li><p><strong>N</strong> – array of sigmas e.g. [-2,-1,0,1,2]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.icelimit.convolve_systematics">
<span class="sig-name descname"><span class="pre">convolve_systematics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syst_error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_toys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log-normal-mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/icelimit.html#convolve_systematics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.icelimit.convolve_systematics" title="Link to this definition">¶</a></dt>
<dd><p>Produce an array of distribution convoluted values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – expected count value</p></li>
<li><p><strong>syst_error</strong> – error size (e.g. standard deviation)</p></li>
<li><p><strong>num_toys</strong> – number of MC samples</p></li>
<li><p><strong>error_type</strong> – type of distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of counts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.icelimit.test_limits_unit_test">
<span class="sig-name descname"><span class="pre">test_limits_unit_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/icelimit.html#test_limits_unit_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.icelimit.test_limits_unit_test" title="Link to this definition">¶</a></dt>
<dd><p>Simple unit tests</p>
</dd></dl>

</section>
<section id="module-icefit.jacobian">
<span id="icefit-jacobian"></span><h2>icefit.jacobian<a class="headerlink" href="#module-icefit.jacobian" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.jacobian.get_full_hessian">
<span class="sig-name descname"><span class="pre">get_full_hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/jacobian.html#get_full_hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.jacobian.get_full_hessian" title="Link to this definition">¶</a></dt>
<dd><p>Compute the full Hessian matrix of a neural net (can be very slow)</p>
<p><a class="reference external" href="https://www.cs.toronto.edu/~rgrosse/courses/csc2541_2021/readings/L02_Taylor_approximations.pdf">https://www.cs.toronto.edu/~rgrosse/courses/csc2541_2021/readings/L02_Taylor_approximations.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> – neural net loss function</p></li>
<li><p><strong>param</strong> – neural net parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.jacobian.get_gradient">
<span class="sig-name descname"><span class="pre">get_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/jacobian.html#get_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.jacobian.get_gradient" title="Link to this definition">¶</a></dt>
<dd><p>Return derivative df(x)/dx or gradient vectors
for f: R^n -&gt; R</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.jacobian.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/jacobian.html#get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.jacobian.get_jacobian" title="Link to this definition">¶</a></dt>
<dd><p>Return Jacobian matrix of size m x n
of a function f: R^n -&gt; R^m</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.jacobian.observed_fisher_info">
<span class="sig-name descname"><span class="pre">observed_fisher_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/jacobian.html#observed_fisher_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.jacobian.observed_fisher_info" title="Link to this definition">¶</a></dt>
<dd><p>Observed Fisher information – the negative of the second derivative
(Hessian matrix) of the log-likelihood function.</p>
<p>The observed information is typically evaluated at the maximum-likelihood estimate of theta.</p>
<p>‘Fisher information represents the curvature of the relative entropy’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logL</strong> – The log-likelihood function l(theta|X1,…X_n) = sum_{i=1}^n log f(X_i|theta),
with X_i being the independent random observations</p></li>
<li><p><strong>inputs</strong> – log-likelihood function input</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Observed_information">https://en.wikipedia.org/wiki/Observed_information</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Optimal_design">https://en.wikipedia.org/wiki/Optimal_design</a></p>
<p>Efron, B.; Hinkley, D.V. (1978). Assessing the accuracy of the maximum likelihood estimator:
Observed versus expected Fisher Information”. Biometrika. 65 (3): 457–487.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.jacobian.test_dimension_interfaces">
<span class="sig-name descname"><span class="pre">test_dimension_interfaces</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/jacobian.html#test_dimension_interfaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.jacobian.test_dimension_interfaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.jacobian.test_hessians">
<span class="sig-name descname"><span class="pre">test_hessians</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/jacobian.html#test_hessians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.jacobian.test_hessians" title="Link to this definition">¶</a></dt>
<dd><p>Test Hessian matrix computations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.jacobian.test_jacobians">
<span class="sig-name descname"><span class="pre">test_jacobians</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/jacobian.html#test_jacobians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.jacobian.test_jacobians" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-icefit.lognormal">
<span id="icefit-lognormal"></span><h2>icefit.lognormal<a class="headerlink" href="#module-icefit.lognormal" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.lognormal.create_label">
<span class="sig-name descname"><span class="pre">create_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/lognormal.html#create_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.lognormal.create_label" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.lognormal.lognormal_param">
<span class="sig-name descname"><span class="pre">lognormal_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/lognormal.html#lognormal_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.lognormal.lognormal_param" title="Link to this definition">¶</a></dt>
<dd><p>Compute log-normal distribution mu and sigma parameters from
the target mean (or median) m and variance v</p>
<p>mu and sigma follow the Wikipedia convention:
<a class="reference external" href="https://en.wikipedia.org/wiki/Log-normal_distribution">https://en.wikipedia.org/wiki/Log-normal_distribution</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> – mean (or median or mode) value of the target log-normal pdf</p></li>
<li><p><strong>v</strong> – variance value of the target log-normal pdf</p></li>
<li><p><strong>match_mode</strong> – input m as ‘mean’, ‘median’, or ‘mode’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.lognormal.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/lognormal.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.lognormal.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.lognormal.rand_lognormal">
<span class="sig-name descname"><span class="pre">rand_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/lognormal.html#rand_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.lognormal.rand_lognormal" title="Link to this definition">¶</a></dt>
<dd><p>Generate random numbers from log-normal density with
the distribution target mean (or median) m and variance v</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> – mean (or median or mode) value of the target log-normal pdf</p></li>
<li><p><strong>v</strong> – variance value of the target log-normal pdf</p></li>
<li><p><strong>N</strong> – number of samples</p></li>
<li><p><strong>match_mode</strong> – input m as ‘mean’, ‘median’, or ‘mode’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.lognormal.rand_powexp">
<span class="sig-name descname"><span class="pre">rand_powexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/lognormal.html#rand_powexp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.lognormal.rand_powexp" title="Link to this definition">¶</a></dt>
<dd><p>Power+exp type parametrization for median matching</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> – median target</p></li>
<li><p><strong>std</strong> – standard deviation target</p></li>
<li><p><strong>N</strong> – number of samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.lognormal.test_accuracy">
<span class="sig-name descname"><span class="pre">test_accuracy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/lognormal.html#test_accuracy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.lognormal.test_accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Test accuracy made in the power-exp approximation with median = 1</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.lognormal.test_lognormal">
<span class="sig-name descname"><span class="pre">test_lognormal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/lognormal.html#test_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.lognormal.test_lognormal" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-icefit.mantissa">
<span id="icefit-mantissa"></span><h2>icefit.mantissa<a class="headerlink" href="#module-icefit.mantissa" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.mantissa.bits2digits">
<span class="sig-name descname"><span class="pre">bits2digits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/icefit/mantissa.html#bits2digits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mantissa.bits2digits" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mantissa.digits2bits">
<span class="sig-name descname"><span class="pre">digits2bits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">digits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/icefit/mantissa.html#digits2bits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mantissa.digits2bits" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mantissa.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mantissa.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mantissa.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mantissa.plots">
<span class="sig-name descname"><span class="pre">plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xhat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dquant_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mantissa_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'None'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'output'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mantissa.html#plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mantissa.plots" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mantissa.reduce_mantissa_bits">
<span class="sig-name descname"><span class="pre">reduce_mantissa_bits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manbits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mantissa.html#reduce_mantissa_bits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mantissa.reduce_mantissa_bits" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – floating point numbers in an array</p></li>
<li><p><strong>manbits</strong> – number of leading bits for the mantissa</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mantissa.reduce_mantissa_digits">
<span class="sig-name descname"><span class="pre">reduce_mantissa_digits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mandigits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mantissa.html#reduce_mantissa_digits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mantissa.reduce_mantissa_digits" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – floating point numbers in an array</p></li>
<li><p><strong>mandigits</strong> – number of digits precision in the mantissa</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mantissa.round_sig">
<span class="sig-name descname"><span class="pre">round_sig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mantissa.html#round_sig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mantissa.round_sig" title="Link to this definition">¶</a></dt>
<dd><p>Round to significant figures</p>
</dd></dl>

</section>
<section id="module-icefit.mine">
<span id="icefit-mine"></span><h2>icefit.mine<a class="headerlink" href="#module-icefit.mine" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="icefit.mine.MINENet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MINENet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[128,</span> <span class="pre">128]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mine.html#MINENet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mine.MINENet" title="Link to this definition">¶</a></dt>
<dd><p>MINE network object</p>
<p>input_size: total (summed) dimension of two random variables, can be different
mlp_dim:    mlp inner dimensionality</p>
<dl class="py method">
<dt class="sig sig-object py" id="icefit.mine.MINENet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mine.html#MINENet.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mine.MINENet.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mine.apply_mine">
<span class="sig-name descname"><span class="pre">apply_mine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losstype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mine.html#apply_mine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mine.apply_mine" title="Link to this definition">¶</a></dt>
<dd><p>Compute Mutual Information by re-applying the trained model</p>
<p>(trained using statistics as input ~ X and Z)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mine.apply_mine_batched">
<span class="sig-name descname"><span class="pre">apply_mine_batched</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losstype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mine.html#apply_mine_batched"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mine.apply_mine_batched" title="Link to this definition">¶</a></dt>
<dd><p>Compute Mutual Information by re-applying the trained model in batches</p>
<p>(trained using statistics as input ~ X and Z)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mine.compute_mine">
<span class="sig-name descname"><span class="pre">compute_mine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marginal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ma_eT</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losstype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MINE_EMA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mine.html#compute_mine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mine.compute_mine" title="Link to this definition">¶</a></dt>
<dd><p>Compute Mutual Information estimate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>joint</strong> – input data</p></li>
<li><p><strong>marginal</strong> – input data</p></li>
<li><p><strong>w</strong> – input data weights</p></li>
<li><p><strong>net</strong> – network object</p></li>
</ul>
</dd>
</dl>
<p>Note that bias corrected loss is used only for the gradient descent,
MI value is calculated without it.</p>
<p class="rubric">Notes</p>
<p>MI_lb is mutual information lower bound (“neural information measure”)
sup E_{P_{XZ}} [T_theta] - log(E_{P_X otimes P_Z}[exp(T_theta)])</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mine.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losstype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MINE_EMA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[128,</span> <span class="pre">128]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_model_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mine.html#estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mine.estimate" title="Link to this definition">¶</a></dt>
<dd><p>Accurate Mutual Information Estimate via Neural Network</p>
<dl class="simple">
<dt>Info:</dt><dd><p>Input data X,Z can be random vectors (with different dimensions)
or just scalar variables.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – input data variable 1 (N x dim1)</p></li>
<li><p><strong>Z</strong> – input data variable 2 (N x dim2)</p></li>
<li><p><strong>weights</strong> – input data weights (N) (set None if no weights)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Params:</dt><dd><p>batch_size  : optimization loop batch size
num_iter    : number of iterations
lr          : learning rate
hidden_dim  : network hidden dimension
loss        : estimator loss ‘MINE_EMA’ (default, unbiased), ‘MINE’
alpha       : exponentially moving average parameter
window _size: iterations (tail) window size for the final estimate</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>MI estimate
MI uncertainty
model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mine.sample_batch">
<span class="sig-name descname"><span class="pre">sample_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu',</span> <span class="pre">index=0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mine.html#sample_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mine.sample_batch" title="Link to this definition">¶</a></dt>
<dd><p>Sample batches of data, either from the joint or marginals</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – input data (N x dim)</p></li>
<li><p><strong>Z</strong> – input data (N x dim)</p></li>
<li><p><strong>weights</strong> – input weights (N)</p></li>
<li><p><strong>batch_size</strong> – batch size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>joint, marginal batches with size (N x [dim[X] + dim[Z]])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.mine.train_loop">
<span class="sig-name descname"><span class="pre">train_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losstype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu',</span> <span class="pre">index=0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/mine.html#train_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.mine.train_loop" title="Link to this definition">¶</a></dt>
<dd><p>Train the network estimator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>estimate</strong><strong>(</strong><strong>)</strong> (<em>See</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mutual information estimates per iteration</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-icefit.peakfit">
<span id="icefit-peakfit"></span><h2>icefit.peakfit<a class="headerlink" href="#module-icefit.peakfit" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.peakfit.fit_and_analyze">
<span class="sig-name descname"><span class="pre">fit_and_analyze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/peakfit.html#fit_and_analyze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.peakfit.fit_and_analyze" title="Link to this definition">¶</a></dt>
<dd><p>Main analysis steering</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.peakfit.fit_task">
<span class="sig-name descname"><span class="pre">fit_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputparam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">YEAR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GENTYPE</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/peakfit.html#fit_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.peakfit.fit_task" title="Link to this definition">¶</a></dt>
<dd><p>Main fitting task for ‘single’ histogram fits</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.peakfit.fit_task_multi">
<span class="sig-name descname"><span class="pre">fit_task_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputparam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">YEAR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GENTYPE</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/peakfit.html#fit_task_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.peakfit.fit_task_multi" title="Link to this definition">¶</a></dt>
<dd><p>Main fitting task for ‘dual’ (‘Pass’ and ‘Fail’ simultaneous) histogram fits</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.peakfit.get_rootfiles_jpsi">
<span class="sig-name descname"><span class="pre">get_rootfiles_jpsi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">years</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2016,</span> <span class="pre">2017,</span> <span class="pre">2018]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systematics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Nominal']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/peakfit.html#get_rootfiles_jpsi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.peakfit.get_rootfiles_jpsi" title="Link to this definition">¶</a></dt>
<dd><p>Return rootfile names for the J/psi (muon) study.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.peakfit.group_systematics">
<span class="sig-name descname"><span class="pre">group_systematics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/peakfit.html#group_systematics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.peakfit.group_systematics" title="Link to this definition">¶</a></dt>
<dd><p>Group and print results of systematic fit variations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.peakfit.run_jpsi_peakfit">
<span class="sig-name descname"><span class="pre">run_jpsi_peakfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputparam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/peakfit.html#run_jpsi_peakfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.peakfit.run_jpsi_peakfit" title="Link to this definition">¶</a></dt>
<dd><p>J/psi peak fitting with multiprocessing over kinematic ‘hyperbins’ via Ray</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.peakfit.run_jpsi_tagprobe">
<span class="sig-name descname"><span class="pre">run_jpsi_tagprobe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputparam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/peakfit.html#run_jpsi_tagprobe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.peakfit.run_jpsi_tagprobe" title="Link to this definition">¶</a></dt>
<dd><p>Tag &amp; Probe efficiency (&amp; scale factors)</p>
</dd></dl>

</section>
<section id="module-icefit.score">
<span id="icefit-score"></span><h2>icefit.score<a class="headerlink" href="#module-icefit.score" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.score.logL">
<span class="sig-name descname"><span class="pre">logL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/score.html#logL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.score.logL" title="Link to this definition">¶</a></dt>
<dd><p>Log likelihood function logL(mu,sigma | X)</p>
</dd></dl>

</section>
<section id="module-icefit.statstools">
<span id="icefit-statstools"></span><h2>icefit.statstools<a class="headerlink" href="#module-icefit.statstools" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.ADS">
<span class="sig-name descname"><span class="pre">ADS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#ADS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.ADS" title="Link to this definition">¶</a></dt>
<dd><p>Asimov discovery significance with background uncertainty
<a class="reference external" href="https://indico.cern.ch/event/708041/papers/3272129/files/9437-acat19DirectOpti.pdf">https://indico.cern.ch/event/708041/papers/3272129/files/9437-acat19DirectOpti.pdf</a></p>
<p>when sigma_b –&gt; 0, this gives np.sqrt(2*((s+b)*np.log(1.0 + s/b) - s))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> – expected signal count</p></li>
<li><p><strong>b</strong> – expected background count</p></li>
<li><p><strong>sigma_b</strong> – error on the background estimate</p></li>
<li><p><strong>EPS</strong> – regularization constant</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.analytical_extreme_npdf">
<span class="sig-name descname"><span class="pre">analytical_extreme_npdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#analytical_extreme_npdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.analytical_extreme_npdf" title="Link to this definition">¶</a></dt>
<dd><p>Analytical expectation (mean) value approximation (based on an expansion)
for a normal pdf max (extreme) values with a sample size of N.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Extreme_value_theory">https://en.wikipedia.org/wiki/Extreme_value_theory</a>
<a class="reference external" href="https://en.wikipedia.org/wiki/Gumbel_distribution">https://en.wikipedia.org/wiki/Gumbel_distribution</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.clopper_pearson_err">
<span class="sig-name descname"><span class="pre">clopper_pearson_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.025,</span> <span class="pre">0.975]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#clopper_pearson_err"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.clopper_pearson_err" title="Link to this definition">¶</a></dt>
<dd><p>Clopper-Pearson binomial proportion confidence interval.
Below, beta.ppf (percent point functions) returns inverse CDF for quantiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> – observed success counts</p></li>
<li><p><strong>n</strong> – number of trials</p></li>
<li><p><strong>CL</strong> – confidence levels [lower, upper]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>confidence interval [lower, upper]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.columnar_mask_efficiency">
<span class="sig-name descname"><span class="pre">columnar_mask_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">den_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#columnar_mask_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.columnar_mask_efficiency" title="Link to this definition">¶</a></dt>
<dd><p>Masked columnar selection efficiency with event weights and classes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mask</strong> – numerator mask vector (Nx1, bool)</p></li>
<li><p><strong>den_mask</strong> – denominator mask      (Nx1, bool)</p></li>
<li><p><strong>y_true</strong> – label vector          (Nx1, int)</p></li>
<li><p><strong>y_target</strong> – target label          (int)</p></li>
<li><p><strong>weights</strong> – event weights         (Nx1, float)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>binomial efficiency, weighted binomial stat. error</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.cormat2covmat">
<span class="sig-name descname"><span class="pre">cormat2covmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#cormat2covmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.cormat2covmat" title="Link to this definition">¶</a></dt>
<dd><p>Convert a correlation matrix to a covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> – correlation matrix (NxN)</p></li>
<li><p><strong>s</strong> – vector of standard deviations (N)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.correlation_matrix">
<span class="sig-name descname"><span class="pre">correlation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#correlation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.correlation_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Compute a (sample weighted) correlation or covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – Data matrix (rows as sample points, columns as variables)</p></li>
<li><p><strong>weights</strong> – Weights per sample</p></li>
<li><p><strong>return_cov</strong> – Return covariance matrix (not correlation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>correlation matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.covmat2corrmat">
<span class="sig-name descname"><span class="pre">covmat2corrmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#covmat2corrmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.covmat2corrmat" title="Link to this definition">¶</a></dt>
<dd><p>Covariance matrix to correlation matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>C</strong> – Covariance matrix</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Correlation matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.error_on_mu">
<span class="sig-name descname"><span class="pre">error_on_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#error_on_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.error_on_mu" title="Link to this definition">¶</a></dt>
<dd><p>Standard error estimate on a sample mean.
<a class="reference external" href="https://web.eecs.umich.edu/~fessler/papers/files/tr/stderr.pdf">https://web.eecs.umich.edu/~fessler/papers/files/tr/stderr.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigma</strong> – sample standard deviation
n  : sample size</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.error_on_std">
<span class="sig-name descname"><span class="pre">error_on_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#error_on_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.error_on_std" title="Link to this definition">¶</a></dt>
<dd><p>Standard error estimate on a sample standard deviation.
<a class="reference external" href="https://web.eecs.umich.edu/~fessler/papers/files/tr/stderr.pdf">https://web.eecs.umich.edu/~fessler/papers/files/tr/stderr.pdf</a>
:param sigma: sample standard deviation
:param n: sample size</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.geom_mean_2D">
<span class="sig-name descname"><span class="pre">geom_mean_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#geom_mean_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.geom_mean_2D" title="Link to this definition">¶</a></dt>
<dd><p>Geometric 2D mean of x and y (understood e.g. as 1D histograms) element wise
and its error propagation based uncertainty (x,y taken also independent elem. wise)</p>
<p>Math note: outer(u,v)_ij = u_i v_j, with outer(u,v) = uv^T</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – values        (numpy arrays)</p></li>
<li><p><strong>y</strong> – values        (numpy arrays)</p></li>
<li><p><strong>x_err</strong> – uncertainties (numpy arrays)</p></li>
<li><p><strong>y_err</strong> – uncertainties (numpy arrays)</p></li>
<li><p><strong>flip_vertical</strong> – flip the values over the vertical (y) dimension</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D-matrix (with rank 1) and its uncertainty</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>z, z_err</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.mc_extreme_multivariate_npdf">
<span class="sig-name descname"><span class="pre">mc_extreme_multivariate_npdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#mc_extreme_multivariate_npdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.mc_extreme_multivariate_npdf" title="Link to this definition">¶</a></dt>
<dd><p>Extreme value distribution for a multivariate normal pdf via Monte Carlo,
e.g. for “correlated measurements or bins” – casted as a univariate problem
such that maximum of components is taken (not a “vector maximum”)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – scalar value to evaluate the extreme value pdf upper tail integral</p></li>
<li><p><strong>mu</strong> – mean vector (N)</p></li>
<li><p><strong>cov</strong> – covariance matrix (NxN)</p></li>
<li><p><strong>trials</strong> – number of Monte Carlo samples, as large as possible CPU wise</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>probability for the value x or more extreme
maxvals : full MC distribution of extreme values obtained</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>p_value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.mc_extreme_npdf">
<span class="sig-name descname"><span class="pre">mc_extreme_npdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#mc_extreme_npdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.mc_extreme_npdf" title="Link to this definition">¶</a></dt>
<dd><p>Extreme value distribution for normal pdf via Monte Carlo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – value to evaluate the extreme value pdf upper tail integral</p></li>
<li><p><strong>mu</strong> – mean of normal pdf</p></li>
<li><p><strong>sigma</strong> – std of normal pdf</p></li>
<li><p><strong>N</strong> – sample size</p></li>
<li><p><strong>trials</strong> – number of Monte Carlo samples, as large as possible CPU wise</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>probability for the value x or more extreme
maxvals : full MC distribution of extreme values obtained</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>p_value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.p2zscore">
<span class="sig-name descname"><span class="pre">p2zscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#p2zscore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.p2zscore" title="Link to this definition">¶</a></dt>
<dd><p>p-value to z-score (standard normal sigmas)</p>
<p class="rubric">Example</p>
<p>p-value is divided by two such that
p = 0.05 gives z_{1-alpha/2} = z_{1-0.025} = 1.96</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.poisson_ratio">
<span class="sig-name descname"><span class="pre">poisson_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.025,</span> <span class="pre">0.975])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#poisson_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.poisson_ratio" title="Link to this definition">¶</a></dt>
<dd><p>Poisson ratio uncertainty via conditional ratio
theta = lambda1 / (lambda1 + lambda2)</p>
<p>See e.g. “Confidence limits on the ratio of two Poisson variables, 1974”</p>
<p>E[k1] = lambda1 (Poisson mean)
E[k2] = lambda2 (Poisson mean)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> – observations k1</p></li>
<li><p><strong>k2</strong> – observations k2</p></li>
<li><p><strong>CL</strong> – 2-array of lower and upper quantiles</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ratio confidence interval endpoints</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.poisson_tail">
<span class="sig-name descname"><span class="pre">poisson_tail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#poisson_tail"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.poisson_tail" title="Link to this definition">¶</a></dt>
<dd><p>Single Poisson CDF tail integral. Counts 2 works as the reference.
:param k1: poisson counts 1
:param k2: poisson counts 2 (reference sample)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>p value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.prod_eprop">
<span class="sig-name descname"><span class="pre">prod_eprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaAB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#prod_eprop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.prod_eprop" title="Link to this definition">¶</a></dt>
<dd><p>Error propagation (Taylor expansion) of a product A*B</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – Value A</p></li>
<li><p><strong>B</strong> – Value B</p></li>
<li><p><strong>sigmaA</strong> – 1 sigma uncertainty on A</p></li>
<li><p><strong>sigmaB</strong> – 1 sigma uncertainty on B</p></li>
<li><p><strong>sigmaAB</strong> – Covariance of A,B</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Uncertainty</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.ratio_eprop">
<span class="sig-name descname"><span class="pre">ratio_eprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaAB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#ratio_eprop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.ratio_eprop" title="Link to this definition">¶</a></dt>
<dd><p>Error propagation (Taylor expansion) of a ratio A/B</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – Value A</p></li>
<li><p><strong>B</strong> – Value B</p></li>
<li><p><strong>sigmaA</strong> – 1 sigma uncertainty on A</p></li>
<li><p><strong>sigmaB</strong> – 1 sigma uncertainty on B</p></li>
<li><p><strong>sigmaAB</strong> – Covariance of A,B</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Uncertainty</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.test_efficiency_ratio">
<span class="sig-name descname"><span class="pre">test_efficiency_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">EPS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#test_efficiency_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.test_efficiency_ratio" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.test_extreme_npdf">
<span class="sig-name descname"><span class="pre">test_extreme_npdf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#test_extreme_npdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.test_extreme_npdf" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.test_ratios">
<span class="sig-name descname"><span class="pre">test_ratios</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#test_ratios"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.test_ratios" title="Link to this definition">¶</a></dt>
<dd><p>Test function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.tpratio_taylor">
<span class="sig-name descname"><span class="pre">tpratio_taylor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#tpratio_taylor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.tpratio_taylor" title="Link to this definition">¶</a></dt>
<dd><p>Error propagation on a ratio</p>
<p>r = x/(x+y)</p>
<p>If x and y are e.g. counts from stat. independent histograms,
then xy_err = 0 (~ tag &amp; probe style ratios).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – values</p></li>
<li><p><strong>y</strong> – values</p></li>
<li><p><strong>x_err</strong> – uncertainties</p></li>
<li><p><strong>y_err</strong> – uncertainties</p></li>
<li><p><strong>xy_err</strong> – covariance (err_x * err_y * rho_xy)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Error propagated ratio error</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.weighted_binomial_err">
<span class="sig-name descname"><span class="pre">weighted_binomial_err</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#weighted_binomial_err"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.weighted_binomial_err" title="Link to this definition">¶</a></dt>
<dd><p>Binomial counting efficiency error with weights</p>
<p>For the reference, see:
<a class="reference external" href="https://root.cern/doc/master/TH1_8cxx_source.html#l02962">https://root.cern/doc/master/TH1_8cxx_source.html#l02962</a></p>
<p>If e1 ~ sqrt(b1) and e2 ~ sqrt(b2), one should recover results of this
function by using the proper covariance with:</p>
<p>prodratio_eprop(A=b1, B=b2, sigma_A=e1, sigma_B=e2, sigmaAB=b1, mode=’ratio)</p>
<p>N.B. If b1 == b2, will return 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b1</strong> – binomial numerator (e.g. count or sum of weights)</p></li>
<li><p><strong>b2</strong> – binomial denominator</p></li>
<li><p><strong>e1</strong> – error on the numerator (e.g. sqrt(sum_i(w_i^2))</p></li>
<li><p><strong>e2</strong> – error on the denominator</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="icefit.statstools.welch_ttest">
<span class="sig-name descname"><span class="pre">welch_ttest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/icefit/statstools.html#welch_ttest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#icefit.statstools.welch_ttest" title="Link to this definition">¶</a></dt>
<dd><p>Welch’s two sample t-test for normally distributed variables.
<a class="reference external" href="https://en.wikipedia.org/wiki/Welch%27s_t-test">https://en.wikipedia.org/wiki/Welch%27s_t-test</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X1</strong> – Mean of sample 1</p></li>
<li><p><strong>X2</strong> – Mean of sample 2</p></li>
<li><p><strong>s1</strong> – Standard deviation of sample 1</p></li>
<li><p><strong>s2</strong> – Standard deviation of sample 2</p></li>
<li><p><strong>n1</strong> – Counts in sample 1</p></li>
<li><p><strong>n2</strong> – Counts in sample 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>test statistic
p : p-value from t-distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>t</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="icedqcd.html" class="btn btn-neutral float-left" title="icedqcd" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="icehgcal.html" class="btn btn-neutral float-right" title="icehgcal" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Mikael Mieskolainen, Blackett Laboratory, Imperial College London.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>